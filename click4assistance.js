function InitialiseC4A() {

    // Every Chat Experience used below must be a popup (not embedded)
    // The varible below must match the id of the img used for the chat button

    var ChatImgId = 'customLiveChatButton';

    // Norfolk test
    /*if (
        location.href.toLowerCase().indexOf("norfolk.ncc1-tst.gosshosted.com/24771") != -1
    ) {
        var myChatTool = new C4A.Tools(1, ChatImgId);
        C4A.Run('EE7B45EB-6AE4-4647-9D78-C180455DFAFE');
    }*/

    // NCC ScriptID=1 (Norfolk CC-Chat Experience)
    if (
        location.href.toLowerCase().indexOf("/42566") != -1 ||
        location.href.toLowerCase().indexOf("/42578") != -1 ||
        location.href.toLowerCase().indexOf("/42570") != -1 ||
        location.href.toLowerCase().indexOf("/42580") != -1 ||
        location.href.toLowerCase().indexOf("/42583") != -1 ||
        location.href.toLowerCase().indexOf("/41984") != -1 ||
        location.href.toLowerCase().indexOf("/38796") != -1
    ) {
        var myChatTool = new C4A.Tools(1, ChatImgId);
        C4A.Run('EE7B45EB-6AE4-4647-9D78-C180455DFAFE');
    }

    // NCC ScriptID=2 (TRAINING Experience)

    // NCC ScriptID=3 (Blue Badge Experience)
    if (
        location.href.toLowerCase().indexOf("/39800") != -1 ||
        location.href.toLowerCase().indexOf("/41932") != -1 ||
        location.href.toLowerCase().indexOf("/39802") != -1
    ) {
        var myChatTool = new C4A.Tools(3, ChatImgId);
        C4A.Run('EE7B45EB-6AE4-4647-9D78-C180455DFAFE');
    }

    // NCC Script=4 (General Enquiries)
    if (
        location.href.toLowerCase().indexOf("/38292") != -1 ||
        location.href.toLowerCase().indexOf("/38294") != -1 
    ) {
        var myChatTool = new C4A.Tools(4, ChatImgId);
        C4A.Run('EE7B45EB-6AE4-4647-9D78-C180455DFAFE');
    }

    // NCC Script=5 (Chatbot test)

    // Finance ScriptID=1
    if (
        location.href.toLowerCase().indexOf("/41982") != -1 ||
        location.href.toLowerCase().indexOf("/41983") != -1
    ) {
        var myChatTool = new C4A.Tools(1, ChatImgId);
        C4A.Run('4ff484de-0b0d-4c01-8a74-278d96d4182f');
    }
}
	
//<script src="https://v4in1-si.click4assistance.co.uk/SI.js" type="text/javascript" defer="defer"></script>

//console.log("SI - 080823");
var C4ALoaded=void 0!==(C4A=C4A||{}).Run,C4A=void 0!==C4A.Run?C4A:function(){var h=null,l=[],c=[];this.iOSFix=!0,this.ClearSessionData=function(){v.Data={}},this.SessionData=function(){return JSON.stringify(v.Data)},this.PersistData=function(){return JSON.stringify(r.Data)};var v=new function(){"use strict";var a="_C4AS",t=function(){try{var t=window.location.hostname.toUpperCase();return-1==window.location.href.toUpperCase().indexOf(t)?"Unknown Domain":t.toLowerCase()}catch(t){return"Unknown Domain"}}(),e=function(){try{return encodeURIComponent(document.location.href.split("?")[0])}catch(t){return"Unknown Url"}}();this.Data={AccountGuid:h,Active:!0,IsActiveTracking:!0,IsActiveProspect:!0,SCook:!1,PCook:!1,Access:"",SID:null,HSGUID:null,PageEntryURL:e,PageURL:"",SiteHitUTC:"",PageHitUTC:"",HBINT:0,HBTO:0,DebugIP:"",DebugShowUI:!1,IsPros:!1,IsProsMatchedMethod:0,HostName:t,ReqTool:!0,Tools:[],ProTools:[]},this.ResetData=function(){this.Data={AccountGuid:h,Active:!0,IsActiveTracking:!0,IsActiveProspect:!0,SCook:!1,PCook:!1,Access:"",SID:null,HSGUID:null,PageEntryURL:e,PageURL:"",SiteHitUTC:"",PageHitUTC:"",HBINT:0,HBTO:0,DebugIP:"",DebugShowUI:!1,IsPros:!1,IsProsMatchedMethod:0,HostName:t,ReqTool:!0,Tools:[],ProTools:[]}},this.GetToolByScriptOrExperience=function(t,e){for(var i in this.Data.Tools){var o=this.Data.Tools[i];if(0<t){if(o.ScriptID==t)return o}else if(null!=e&&o.ExpGuid==e)return o}},this.TestCookie=function(){return navigator.cookieEnabled},this.Read=function(){if(window.sessionStorage){var t=sessionStorage.getItem("SISession");A.Log("Session:Read:"+t),null!=t&&(this.Data=JSON.parse(t))}else for(var e=a+"=",i=document.cookie.split(";"),o=0;o<i.length;o++){for(var n=i[o];" "==n.charAt(0);)n=n.substring(1,n.length);0==n.indexOf(e)&&(this.Data=JSON.parse(n.substring(e.length,n.length)))}return null},this.Write=function(){var t=JSON.stringify(this.Data);if(!window.sessionStorage)return document.cookie=a+"="+t+";path=/;SameSite=None; Secure;",!0;sessionStorage.setItem("SISession",t),A.Log("Session:Write:"+t)},this.URL=function(){this.Data.PageURL=encodeURIComponent(document.location.href);var t=JSON.parse(JSON.stringify(this.Data));delete t.ProTools;t="SessionData="+JSON.stringify(t);return(t=(t=(t=(t=(t=(t=t+"&PName="+p.GetPageName())+"&Vis="+r.GetVisits())+"&LastVisUTC="+r.GetLastVisitUTC())+"&Refer="+encodeURIComponent(document.referrer))+"&PID="+r.Data.PID)+"&UnqVID="+p.UniqueVisitorID).length<1800&&(t=t+"&TPushD="+p.GetCustomData()),2e3<t.length&&(A.Log("Session:URL - 2000 Characters exceeded, can process page hit"),this.SendToServer("/LogToDbaseFromClient","Message=Session:URL - 2000 Characters exceeded, can process page hit&sourceLogCode=JS03")),t}},r=new function(){"use strict";var a="_C4AP";this.Data={PID:"",MatchedMethod:0,LastVIUTC:"",Activity:[]},this.TestCookie=function(){return!!C4A.Track.UseCookie&&navigator.cookieEnabled},this.Read=function(){var t=window.localStorage||(window.globalStorage?globalStorage[location.hostname]:null);if(t){t=t.SIPersist;t&&(A.Log("Persist:Read:"+t),this.Data=JSON.parse(t))}else for(var e=a+"=",i=document.cookie.split(";"),o=0;o<i.length;o++){for(var n=i[o];" "==n.charAt(0);)n=n.substring(1,n.length);0==n.indexOf(e)&&(this.Data=JSON.parse(n.substring(e.length,n.length)))}return null},this.Write=function(){if(!C4A.Track.UseCookie)return!1;var t=JSON.stringify(this.Data),e=window.localStorage||(window.globalStorage?globalStorage[location.hostname]:null);return e?(e.SIPersist=t,A.Log("Persist:Write:"+t)):document.cookie=a+"="+t+";SameSite=None; Secure; expires=Tue, 31 Dec 2030 00:00:00 UTC",!0},this.GetVisits=function(){for(var t=0,e=0;e<this.Data.Activity.length;e++)"VI"==this.Data.Activity[e].Type&&t++;return t},this.GetLastVisitUTC=function(){for(var t=this.Data.Activity.length-1;0<=t;t--)if("VI"==this.Data.Activity[t].Type)return this.Data.Activity[t].UTC;return null},this.AddActivity=function(t,e,i,o,n,a){A.Log("Persist.AddActivity()"),""!=t&&(this.Data.PID=t),""!=e&&(this.Data.LastVIUTC=e);a={UTC:i,Type:o,GUID:n,Other:a};10<=this.Data.Activity.length&&this.Data.Activity.shift(),r.Data.Activity.push(a),this.Write()},this.UpdatePID=function(t,e){null!=t&&(this.Data.PID=t),null!=e&&(this.Data.MatchedMethod=e),this.Write()}},p=new function(){"use strict";var t=/<[^>]*>/g,e=null;this.Enabled=!0,this.UseCookie=!0,this.PageName=document.title.replace(t,"").replace("&","%26"),this.AllowProactives=!0,this.UniqueVisitorID=null,this.GetPageName=function(){return this.PageName=("string"==typeof this.PageName?this.PageName:document.title).replace(t,"").replace("&","%26")},this.AddCustomData=function(t){e=t},this.GetCustomData=function(){return e}},u=new function(){"use strict";var o=null,n=null,a=null,e=null;this.Origin=null,this.UniqueVisitorID=null,this.AddOrder=function(t,e,i){o=t,n=e,a=i},this.AddCustomData=function(t){e=t},this.URL=function(){var t="";return t+="&PCook="+v.Data.PCook,t+="&SID="+v.Data.SID,t+="&DebugIP="+v.Data.DebugIP,t+="&PID="+r.Data.PID,t+="&PName="+p.GetPageName(),t+="&PUrl="+document.location.href,t+="&Vis="+r.GetVisits(),t+="&COrigin="+this.Origin,t+="&CUnqVID="+this.UniqueVisitorID,t+="&CCustomD="+e,t+="&COrdRef="+o,t+="&COrdVal="+n,t+="&COrdCur="+a}},d=new function(){"use strict";var e=null;this.UniqueVisitorID=null,this.AddCustomData=function(t){e=t},this.GetCustomData=function(){return e},this.URL=function(){return"&PCook="+v.Data.PCook+"&SID="+v.Data.SID+"&DebugIP="+v.Data.DebugIP+"&PID="+r.Data.PID+"&PName="+p.GetPageName()+"&PUrl="+document.location.href+"&Vis="+r.GetVisits()+"&PUnqVID="+this.UniqueVisitorID+"&PCustomD="+e}},m=new function(){this.UIGetWindowHeightWidth=function(){var t=window,e=document,i=e.documentElement,o=e.getElementsByTagName("body")[0],e=t.innerWidth||i.clientWidth||o.clientWidth,i=t.innerHeight||i.clientHeight||o.clientHeight,o=new Array;return o.Height=i,o.Width=e,o},this.UIGetScrollPosition=function(){var t,e,i,o=new Array;return null!=window.pageYOffset?(o.TopOffset=pageYOffset,o.LeftOffset=pageXOffset):(t=(e=document).documentElement,i=e.body,e=t.scrollLeft||i.scrollLeft||0,i=t.scrollTop||i.scrollTop||0,o.TopOffset=i,o.LeftOffset=e),o},this.UIShowWarning=function(t){var e=document.createElement("div");e.id="C4A_divWarning",e.setAttribute("style","z-index:9999; background-color:red; border:2px solid white; height:160px; width:200px; padding:8px; position:fixed; bottom:0; right:0; color:white; font-family:Arial; font-size:12px;"),e.innerHTML="<strong style='margin-bottom:12px; display:block; font-size:14px;'>Warning</strong>"+t;var i=document.createElement("div");i.setAttribute("style","width:100%; background-color:white; height:1px; margin-bottom:4px;margin-top:12px;");t=document.createElement("div");t.innerHTML='Contact <a href="https://click4assistance.co.uk" target="_blank" title="Contact Click4Assistance" style="color:white;">Click4Assistance</a> support for help and advice.',e.appendChild(i),e.appendChild(t),document.body.appendChild(e)},this.IsDeviceCompatibleForTools=function(){try{var t=navigator.userAgent;if(null==t)return!1;var e=t.toLowerCase();if(0<e.indexOf("android")){for(var i,o,n=t.length,a=e.indexOf("android")+"android".length+1;a<n;++a){var s=t.chatCodeAt(a);if(!(48<=charcode&&charcode<=57||46==charcode)){i=a;break}}for(var r=0,a=i+1;a<n;++a)if(46==(s=t.chatCodeAt(a)))++r;else if(!(48<=s&&s<=57)){++o;break}var l=t.substr(i,o-i);return 2==r&&(e=l.lastIndexOf("."),l=l.substr(0,e)),!(parseInt(l)<5)||(A.Log("Android version is less than 5.0"),-1<l.indexOf("4.0")?(A.Log("Android version is 4.0"),!1):-1<l.indexOf("4.1")?(A.Log("Android version is 4.1"),!1):-1<l.indexOf("4.2")?(A.Log("Android version is 4.2"),!1):(A.Log("Android version is greater than 4.2"),!0))}return!0}catch(t){return!0}},this.IsDeviceiPhone=function(){return!1},this.IsUrlXSS=function(t){try{return 0<t.toLowerCase().indexOf("<script")?(A.Log("IsUrlXSS: "+t),!0):(0<t.toLowerCase().indexOf("<//script>")||0<t.toLowerCase().indexOf("%3c;script")||0<t.toLowerCase().indexOf("script%3e")||0<t.toLowerCase().indexOf("&lt;script")||0<t.toLowerCase().indexOf("javascript%3a"))&&(A.Log("IsUrlXSS: "+t),!0)}catch(t){return!1}},this.IsGuid=function(t){try{return null==t||""==t?!1:/^(\{){0,1}[0-9a-fA-F]{8}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{12}(\}){0,1}$/.test(t)}catch(t){return!0}}},S=new function(){"use strict";var i=120,o=null,e=null,n=0,a=!1,s=null;this.DomainSI="https://v4in1-si.click4assistance.co.uk",this.DomainTI="https://v4in1-ti.click4assistance.co.uk",this.SendToServer=function(t,e){var i,o,n="C4A_ScriptSend";a||(null!=h&&""!=h?m.IsGuid(h)?(i=this.DomainSI+t+"?AccGUID="+h+"&"+e+"&"+Math.random(),A.Log("Comms.SendToServer() => "+i),t=(o=window.document).getElementsByTagName("head").item(0),(e=o.getElementById(n))&&t.removeChild(e),(o=o.createElement("script")).src=encodeURI(i),o.type="text/javascript",o.defer=!0,o.id=n,t.appendChild(o)):console.warn("SendToServer(): _accountGuid is an invalid guid"):console.warn("SendToServer(): _accountGuid is empty"))},this.StartHeartBeat=function(){var t;v||v.Data?0!=v.Data.Active&&(!isNaN(v.Data.HBINT)&&0!=v.Data.HBINT||(v.Data.HBINT=5),(isNaN(v.Data.HBTO)||0==v.Data.HBTO||10<=v.Data.HBTO)&&(v.Data.HBTO=5),i=60/v.Data.HBINT*v.Data.HBTO,o=(new Date).setMinutes((new Date).getMinutes()+v.Data.HBTO),t=1e3*v.Data.HBINT,A.Log("Comms.StartHeartBeat() => delay: "+t+"ms"),null!=e&&(clearInterval(e),A.Log("Comms.StartHeartBeat() - Heartbeat Timer cleared")),e=window.setInterval(S.SendHeartBeat,t)):A.Log("Comms.StartHeartBeat() - No Session or No Session.Data")},this.StopHeartBeat=function(){window.clearInterval(e),o=e=null,n=0,A.Log("Comms.StopHeartBeat()")},this.SendHeartBeat=function(){if(n++,null!=o)if(new Date>o)S.StopHeartBeat();else if(i<n)S.StopHeartBeat();else if(a)S.StopHeartBeat();else{if(!v&&!v.Data)return A.Log("Comms.SendHeartBeat() - No Session or No Session.Data"),void S.StopHeartBeat();var t,e=document.location.href;m.IsUrlXSS(e)?S.StopHeartBeat():(e=e.split("?")[0],e=encodeURIComponent(e),t="&Active="+v.Data.Active,t+="&Access="+v.Data.Access,t+="&SID="+v.Data.SID,t+="&DebugIP="+v.Data.DebugIP,t+="&PUrl="+e,S.SendToServer("/HeartBeat",t))}else S.StopHeartBeat()},this.GetPageName=function(t){switch(t){case 1:case 2:return"DefaultChat.aspx";case 3:return"DefaultSmartContact.aspx";case 4:return"DefaultClick2Call.aspx";case 5:return"DefaultMeetingRoom.aspx";case 6:return"DefaultPromotion.aspx";default:A.Log("Comms.GetPageName() => [INVALID TOOLTYPE] ToolType:"+t)}},this.CreateProactiveSession=function(t,e){s=t,S.SendToServer("/CreateProactiveSession",e)},this.CB_Initilize=function(){var e,t;v.Data.DebugShowUI&&C4A.Debug.DisplayPanel(),A.Log("Comms.CB_Initilize()"),A.Log("Comms.CB_Initilize() => There are "+(l?l.length:"0")+" (fixed tools) in the collection"),l&&l.forEach(function(t,e){A.Log("Comms.CB_Initilize() => Tool: "+(e+1)+" Rendering Button & Widget - ScriptId: "+t.ScriptID),t.Button.Render(),t.Widget.Render();var i=v.GetToolByScriptOrExperience(t.ScriptID,t.ExpGuid);i?(A.Log("Comms.CB_Initilize() => Tool: "+(e+1)+" - Displayed: "+i.Displayed),i.Displayed&&t.Widget.Open()):A.Log("Comms.CB_Initilize() => Unable to find tool using ScriptID: "+t.ScriptID+" OR ExpGuid:"+t.ExpGuid)}),A.Log("Comms.CB_Initilize() => There are "+(v.Data.ProTools?v.Data.ProTools.length:"ZERO")+" (proactive tools) in the collection"),v.Data.ProTools&&(e=!0,v.Data.ProTools.forEach(function(t){t.Dis&&-1<[1,2,4].indexOf(t.TT)&&(e=!1,A.Log("Comms.CB_Initilize() => The ProTool is set to be displayed - EGuid: "+t.EGuid),T.Issue(t,t.Rules[0]))}),e&&v.Data.ProTools.forEach(function(t){t.Dis&&(A.Log("Comms.CB_Initilize() => The ProTool is set to be displayed - EGuid: "+proTool.EGuid),T.Issue(t,t.Rules[0]))})),!0===v.Data.PCook&&r.Read(),!0===p.Enabled&&!0===v.Data.IsActiveTracking?(t=!1,null!==d.UniqueVisitorID&&!0===v.Data.Active&&"T"===v.Data.Access.substr(1,1)&&(A.Log("Comms.CB_Initilize() => Sending prospect data"),this.SendToServer("/AddProspect",d.URL()),t=!0),null!==d.UniqueVisitorID&&"F"===v.Data.Access.substr(1,1)&&(m.UIShowWarning("Prospect feature is disabled – You must remove the prospect script to prevent this warning appearing."),this.SendToServer("/LogToDbaseFromClient","Message=A prospect was attempted to be added, but prospects are disabled&sourceLogCode=JS02")),null!=u.Origin&&"F"==v.Data.Access.substr(2,1)?(m.UIShowWarning("Conversion are Disabled – you must remove the conversion script to prevent this warning appearing."),C4A.Comms.SendToServer("/LogToDbaseFromClient","Message=A conversion was attempted to be added, but conversions are disabled&sourceLogCode=JS01")):null!==u.Origin&&!0===v.Data.Active&&"T"===v.Data.Access.substr(2,1)&&(t?setTimeout(function(){A.Log("Comms.CB_Initilize() => Sending conversion data (with 1000ms delay)"),C4A.Comms.SendToServer("/AddConversion",u.URL())},1e3):(A.Log("Comms.CB_Initilize() => Sending conversion data"),C4A.Comms.SendToServer("/AddConversion",u.URL()))),v.Write(),S.StartHeartBeat(),T.Initilize()):A.Log("Comms.CB_Initilize() => Tracking not enabled - Prospects, Conversions, Heartbeat & Proactives not processed")},this.CB_DDosAttack=function(){A.Log("Comms.CB_DDosAttack()"),a=!0},this.CB_SessionWrite=function(t){var e,i,o;A.Log("Comms.CB_SessionWrite() => "+t),v||v.Data?(e=v.Data.PageURL,i=v.Data.SiteHitUTC,o=v.Data.PageHitUTC,v.Data=JSON.parse(t),v.Data.PageURL=e,v.Data.SiteHitUTC=i,v.Data.PageHitUTC=o,""===v.Data.SiteHitUTC&&(v.Data.SiteHitUTC=Math.floor((new Date).getTime()/1e3)),""===v.Data.PageHitUTC&&(v.Data.PageHitUTC=Math.floor((new Date).getTime()/1e3)),o=encodeURIComponent(document.location.href),v.Data.PageURL!==o&&(v.Data.PageURL=o,v.Data.PageHitUTC=Math.floor((new Date).getTime()/1e3)),v.Write(),v.Read()):A.Log("Comms.CB_SessionWrite() - No Session or No Session.Data")},this.CB_AddActivity=function(t,e,i,o,n,a){A.Log("Comms.CB_AddActivity() => "+t+" - "+e+" - "+i+" - "+o+" - "+n+" - "+a),r.AddActivity(t,e,i,o,n,a),r.Write(),r.Read()},this.CB_UpdatePID=function(t,e){A.Log("Comms.CB_UpdatePID() => pid: "+t+" - matchedMethod: "+e),v.Data.IsPros=!0,v.Data.IsProsMatchedMethod=e,v.Write(),v.Read(),r.UpdatePID(t,e),r.Write(),r.Read()},this.CB_RequestPersistentCookie=function(){var t;A.Log("Comms.CB_RequestPersistentCookie()"),!1!==v.Data.IsActiveTracking&&null!==v.Data.SID&&"null"!==v.Data.SID&&(r.Read(),t="SID="+v.Data.SID+"&PersistData="+JSON.stringify(r.Data),S.SendToServer("/AcceptPersistentData/",t))},this.CB_UIShowWarning=function(t){A.Log("Comms.CB_UIShowWarning() => "+t),m.UIShowWarning(t)},this.CB_AnimatePreDialogWindow=function(t,e,i,o){var n,a=document.getElementById("iFraC4AW"+o);a?(n=null,l&&l.forEach(function(t){t.ScriptID==o&&(n=t.Widget?t.Widget.Animation():null)}),n?(n.Initilize(a,t,e,i,!1),n.ScriptId=o,A.Log("Comms.CB_AnimatePreDialogWindow() => Animate(4)"),n.Animate(4)):A.Log("Comms.CB_AnimatePreDialogWindow() => Tool / Animation not found for script id: "+o)):A.Log("Comms.CB_AnimatePreDialogWindow() => iFraC4AW iframe not found for script id:"+o)},this.CB_ResizeWindow=function(e,i,o,n){var a=document.getElementById("iFraC4AW"+o);a?v.Data.Tools&&v.Data.Tools.forEach(function(t){t.ScriptID!=o||t.Width==e&&t.Height==i||(a.style.width=e+"px",a.style.height=i+"px",(t=v.GetToolByScriptOrExperience(o,n)).Width=e,t.Height=i,v.Write())}):A.Log("Comms.CB_ResizeWindow() iFraC4AW iframe not found for script id:"+o)},this.CB_ResizeWindowWithAnimation=function(r,l,c,u){var d=document.getElementById("iFraC4AW"+c);d?v.Data.Tools&&v.Data.Tools.forEach(function(t){var e,i,o,n,a,s;t.ScriptID===c&&(e=parseFloat(d.style.width,10)+r+"px",i=parseFloat(d.style.height,10)+l+"px",o=0,n=r/20,a=l/20,s=null,s=setInterval(function(){if(20<=o){d.style.width=e,d.style.height=i;var t=v.GetToolByScriptOrExperience(c,u);return t.Width=d.style.width,t.Height=d.style.height,v.Write(),void clearInterval(s)}0!=n&&(d.style.width=d.offsetWidth+n+"px"),0!=a&&(d.style.height=d.offsetHeight+a+"px"),o++},25))}):A.Log("Comms.CB_ResizeWindowWithAnimation() iFraC4AW iframe not found for script id:"+c)},this.CB_ReceivePostMessage=function(t){A.Log("Comms.CB_ReceivePostMessage() => event.data: "+t.data);var e=t.origin||t.originalEvent.origin;if(e==C4A.Comms.DomainTI){if(3<=t.data.length&&"!_{"!=t.data.substring(0,3))if(A.Log("Comms.CB_ReceivePostMessage() => About to evaluate"),-1!=t.data.indexOf("window.location.href")){var i=t.data.replace("window.location.href=","").replace(/("|')/g,"");A.Log("Comms.CB_ReceivePostMessage() => window.location.href = "+i),window.location.href=i}else{var t=t.data.replace("C4A.Comms.","").replace(/, /g,",").replace(");","").split("("),o=t[0],n=t[1].split(",");switch(o){case"CB_ChatClear":C4A.Comms.CB_ChatClear(n[0].replace(/'/g,""));break;case"CB_ChatCreated":C4A.Comms.CB_ChatCreated(n[0].replace(/'/g,""),n[1].replace(/'/g,""),n[2].replace(/'/g,""),n[3].replace(/'/g,""),n[4].replace(/'/g,""),n[5].replace(/'/g,""));break;case"CB_CloseProactive":C4A.Comms.CB_CloseProactive();break;case"CB_CloseWidget":C4A.Comms.CB_CloseWidget(Number(n[0]));break;case"CB_MinimiseWidget":C4A.Comms.CB_MinimiseWidget(Number(n[0]));break;case"CB_ResetTools":C4A.Comms.CB_ResetTools();break;case"CB_ResizeWindow":C4A.Comms.CB_ResizeWindow(Number(n[0]),Number(n[1]),Number(n[2]),n[3].replace(/'/g,""));break;case"CB_ResizeWindowWithAnimation":C4A.Comms.CB_ResizeWindowWithAnimation(Number(n[0]),Number(n[1]),Number(n[2]),n[3].replace(/'/g,""));break;case"CB_StopProactiveTimer":C4A.Comms.CB_StopProactiveTimer();break;default:A.Log('Comms.CB_ReceivePostMessage() => Invalid function: "'+o+'"')}}}else A.Log("Comms.CB_ReceivePostMessage() => [ERROR] Invalid Origin: ("+e+") - C4A.Comms.DomainTI: ("+C4A.Comms.DomainTI+")")},this.CB_ProactiveSessionCreated=function(t){"function"==typeof s&&s(t),s=null},this.CB_IssueProactive=function(t,e){var i;A.Log("Comms.CB_IssueProactive() => toolIdx: "+t+", ruleIdx: "+e),!1!==m.IsDeviceCompatibleForTools()&&(null!==(i=v.Data.ProTools)&&T.Issue(i[t],i[t].Rules[e]),v.Write())},this.CB_DontIssueProactive=function(t,e){A.Log("Comms.CB_DontIssueProactive() => toolIdx: "+t+", ruleIdx: "+e);var i=v.Data.ProTools;null!==i&&(i[t].Rules[e].S="VOID"),v.Write()},this.CB_CloseProactive=function(){A.Log("Comms.CB_CloseProactive()"),T.CloseProactive();var t=v.Data.ProTools;t.forEach(function(t,e){t.Dis=!1});var i=999;t.forEach(function(t,e){0==t.Rules[0].RT&&(i=e)}),999!==i&&(t.splice(i,1),A.Log("Comms.CB_CloseProactive() => Manual proactive removed from array")),v.Write()},this.CB_ChatCreated=function(e,i,o,n,a,t){A.Log("Comms.CB_ChatCreated() => experienceGuid: "+e+" - instanceGuid: "+i+" - chatGuid: "+o+" - chatAccountGuid: "+n+" - chatExperienceGuid: "+a+" - chatStartDTS: "+t),this.CB_AddActivity("","",t,"CH",o,"");var s=v.Data.IsActiveProactive=!1;v.Data.Tools?v.Data.Tools.forEach(function(t){t.ExpGuid.toUpperCase()==e.toUpperCase()&&(s=!0,t.ChatGuid=o.toUpperCase(),t.ChatAccountGuid=n.toUpperCase(),t.ChatExperienceGuid=a.toUpperCase())}):A.Log("Comms.CB_ChatCreated() => There are no Tools"),v.Data.ProTools?v.Data.ProTools.forEach(function(t){t.EGuid.toUpperCase()===e.toUpperCase()&&(s=!0,t.ChatGuid=o.toUpperCase(),t.ChatAccountGuid=n.toUpperCase(),t.ChatExperienceGuid=a.toUpperCase(),t.InstanceGuid=i.toUpperCase(),t.Dis=!0)}):A.Log("Comms.CB_ChatCreated() => There are no ProTools"),!1===s?A.Log("Comms.CB_ChatCreated() => [Error]: Unable to find Tool/Proactive"):A.Log("Comms.CB_ChatCreated() => Tool/Proactive found and updated with chatGuid"),v.Write()},this.CB_ChatClear=function(i){A.Log("Comms.CB_ChatClear() => experienceGuid: "+i);var o=-1,n=!1;v.Data.Tools&&(v.Data.Tools.forEach(function(t,e){t.ExpGuid.toUpperCase()==i.toUpperCase()&&(n=!0,t.ChatAccountGuid=null,t.ChatExperienceGuid=null,t.ChatGuid=null,t.Displayed=!1,9999==t.ScriptID&&(o=e))}),-1!=o&&v.Data.Tools.splice(o,1)),o=-1,l&&(l.forEach(function(t,e){9999==t.ScriptID&&(o=e)}),-1!=o&&l.splice(o,1)),v.Data.ProTools&&(v.Data.ProTools.forEach(function(t,e){t.EGuid.toUpperCase()==i.toUpperCase()&&0==t.Rules[0].RT&&(o=e,n=!0)}),-1!==o&&v.Data.ProTools.splice(o,1)),A.Log("Comms.CB_ChatClear() =>  found: "+n),v.Write()},this.CB_ResetTools=function(){A.Log("Comms.CB_ResetTools()"),l&&l.forEach(function(t){t.Widget.Close(!1)}),v.Data.Tools&&v.Data.Tools.forEach(function(t){t.Displayed=!1,t.ChatGuid=null,t.ChatAccountGuid=null}),v.Data.ProTools&&v.Data.ProTools.forEach(function(t){t.Dis=!1,t.ChatGuid&&(t.ChatGuid=null),t.ChatAccountGuid&&(t.ChatAccountGuid=null),t.ChatExperienceGuid&&(t.ChatExperienceGuid=null),t.InstanceGuid&&(t.InstanceGuid=null)}),T.CloseProactive(),v.Write()},this.CB_OpenWidget=function(e){A.Log("Comms.CB_OpenWidget() => scriptId: "+e),l&&0!=e&&l.forEach(function(t){t.ScriptID==e&&t.Widget.Open(void 0,!0)})},this.CB_CloseWidget=function(t){A.Log("Comms.CB_CloseWidget() => scriptId: "+t),l&&0!=t&&l.forEach(function(t){t.Widget.Close(!1)}),v.Write()},this.CB_MinimiseWidget=function(e){A.Log("Comms.CB_MinimiseWidget() => scriptId: "+e),l&&0!=e&&l.forEach(function(t){t.ScriptID==e&&t.Widget.Close(!0)}),v.Write()},this.CB_HotspotHit=function(t){A.Log("Comms.CB_HotspotHit() => hotspotGuid: "+t),v.Data.HSGUID=t.toUpperCase(),v.Write()},this.CB_AddProactiveTool=function(t){v.Data.ProTools.push(t),T.Initilize()},this.CB_DisplayManualProactive=function(t,e,i,o,n,a,s,r,l,c,u){var d=[],u={RT:0,RM:"",RDS:1,RS:u};d.push(u);i={PGUID:t,EGuid:e,Dis:!1,TT:o,IT:4,H:a,W:s,GO:r,AId:l,ET:0,EM:0,EDWMin:c,SPGUID:i,Rules:d};v.Data.ProTools.push(i);d=v.Data.ProTools.length-1;1==i.TT||2==i.TT||4==i.TT?(d="ExpGuid="+i.EGuid+"&ToolIdx="+d+"&RuleIdx=0",A.Log("Proactive.CheckRules() => IsExperienceAvailable - Sending data: "+d),S.SendToServer("/IsExperienceAvailable",d)):T.Issue(i,i.Rules[0])},this.CB_StopProactiveTimer=function(){T.StopProactiveTimer()}},T=new function(){var s,n=[],a=[],e=null,r=0,f=0,l=null,c=null,u=null,d=null;function I(){A.Log("Proactive.StopTimerAndVoidAllRules() - Stopping Timer, and setting all Proactive Rules to VOID"),C4A.Proactive.StopProactiveTimer();var t=v.Data.ProTools;if(null!=t)for(var e in t)for(var i in t[e].Rules)t[e].Rules[i].S="VOID"}this.AddUrlData=function(t){c=t},this.AddCustomData=function(t){u=t},this.AddCustomDataGuid=function(t){d=t},this.AddPage=function(t,e){var i=isNaN(t)||null==t,o=e.length<4||null==e;i||o||(n.push(t),a.push(e))},this.CloseProactive=function(){l&&(l.Close(),l=null)},this.Initilize=function(){var i,o,t;A.Log("Proactive.Initilize()"),p.AllowProactives?m.IsDeviceCompatibleForTools()?v.Data.IsActiveProactive?"T"==v.Data.Access.substr(3,1)?null==(t=v.Data.ProTools)||null!=t&&0==t.length?A.Log("Proactive.Initilize() No Proactives - No need to check rules"):(i=0,o=m.UIGetWindowHeightWidth().Width,t.forEach(function(t){if(0!=t.EDWMin&&t.EDWMin>=o||0!=t.EDWMax&&t.EDWMax<=o){for(var e in t.Rules)t.Rules[e].S="VOID";++i}}),t=t.length,i!=t?(A.Log("Proactive.Initilize() There are "+t+" proactives that need to be checked..."),null!=e&&(clearInterval(e),e=null),f=Math.floor((new Date).getTime()/1e3),e=setInterval(function(){0==T.CheckRules()&&(clearInterval(e),e=null)},5e3),A.Log("Proactive.Initilize() Timer started, every 5 seconds...")):A.Log("Proactive.Initilize() All rules exceptions are below the screen width of:"+o+" - No need to check rules")):A.Log("Proactive.Initilize() Proactives not allowed - No need to check rules"):A.Log("Proactive.Initilize() Proactives are not active, possibly a previous chat has occurred - No need to check rules"):A.Log("Proactive.Initilize() IsDeviceCompatibleForTools returned false - No need to check rules"):A.Log("Proactive.Initilize() Track.AllowProactives returned false - No need to check rules")},this.CheckRules=function(){A.Log("Proactive.CheckRules()");var t,e=Math.floor((new Date).getTime()/1e3),i=window.location.host.toUpperCase().replace("WWW.",""),o=window.location.href.toUpperCase(),n=null;null!=v.Data.HSGUID&&(n=v.Data.HSGUID.toString().toUpperCase());if(A.Log("Proactive.CheckRules() _proTimerStarted: "+f+" - lNow:"+e),f+600<e)return A.Log("Proactive.CheckRules() ProactiveTimer Limit (600) secs exceeded, stopping the timer"),!1;var a=v.Data.ProTools;if(null==a)return A.Log("Proactive.CheckRules() ProTools is NULL - returning"),!1;if(0==v.Data.IsActiveProactive)return A.Log("Proactive.CheckRules() Proactives are not active, a previous chat has occurred - StopTimerAndVoidAllRules()"),I(),!1;A.StartGroup("Proactive.CheckRules() Looping REACTIVE Tools");var s=v.Data.Tools;for(l in s){var r=s[l];A.Log("Proactive.CheckRules() Checking Reactive Tool "+(parseInt(l)+1)+" of "+s.length),null!=r.ChatGuid&&(A.Log("Proactive.CheckRules() Visitor has or is in a chat - StopTimerAndVoidAllRules()"),I()),r.Displayed&&(A.Log("Proactive.CheckRules() Visitor has a tool displayed - StopTimerAndVoidAllRules()"),I())}A.EndGroup();var l,c=0;for(l in a)for(u in(r=a[l]).Rules)"PROCESS"==(d=r.Rules[u]).S&&c++;if(0==c)return A.Log("Proactive.CheckRules() There are no rules that need to be processed"),!1;for(l in A.StartGroup("Proactive.CheckRules() Looping PROACTIVE Tools"),A.Log("Proactive.CheckRules() Globals:\n\tNOW: "+e+"\n\tSession.Data.SiteHitUTC: "+v.Data.SiteHitUTC+"\n\tSession.Data.PageHitUTC: "+v.Data.PageHitUTC+"\n\twindow.location.host: "+i+"\n\tSession.Data.HSGUID: "+n),a){var u,r=a[l];for(u in A.StartGroup("Proactive.CheckRules() Looping Rules for Tool "+(parseInt(l)+1)+" of "+a.length+" (ToolType: "+r.TT+", NextCheckUTC: "+r.NextCheckUTC+")"),r.Rules){var d=r.Rules[u];if(A.StartGroup("Proactive.CheckRules() Checking Rule "+(parseInt(u)+1)+" of "+r.Rules.length),"VOID"!=d.S&&"ISSUED"!=d.S)if(t=d.RM.toUpperCase(),A.Log("Proactive.CheckRules() Rule data:\n\tRT  (Rule Type)      : "+d.RT+"\n\tRM  (Rule Match)     : "+t+"\n\tRDS (Rule Delay Secs): "+d.RDS),e<=r.NextCheckUTC)A.Log("Proactive.CheckRules() NextCheckUTC is AFTER NOW, no need to check this rule"),A.EndGroup();else{var h=1==d.RT&&t==i,p=2==d.RT&&t==o,C=3==d.RT&&-1<o.indexOf(t),g=4==d.RT&&t==n,m=g?"HOTSPOT":C?"CONTAINS":p?"EXACT":h?"DOMAIN":"",D=v.Data.SiteHitUTC+d.RDS;if((h||p||C||g)&&D<e){if(1!=r.TT&&2!=r.TT&&4!=r.TT)return A.Log('Proactive.CheckRules() MATCHED  - "'+m+'" - Not a Chat/Video/Click2Call proactive - call Proactive.Issue()'),T.Issue(r,d),A.EndGroup(),!0;g="ExpGuid="+r.EGuid+"&ToolIdx="+l+"&RuleIdx="+u;return A.Log('Proactive.CheckRules() MATCHED  - "'+m+'" - Its a Chat/Video/Click2Call proactive - call end-point IsExperienceAvailable - With data:'+g),S.SendToServer("/IsExperienceAvailable",g),A.EndGroup(),!0}A.Log('Proactive.CheckRules() NO MATCH - "'+m+'" - NOW: '+e+" - ISSUEON: "+D+" - DIFF: "+(D-e)),A.EndGroup()}else A.Log('Proactive.CheckRules() Rule marked as "'+d.S+'"'),A.EndGroup()}A.EndGroup()}A.EndGroup(),A.EndGroup()},this.BuildiFrame=function(t,e){var i=document.getElementById("iFraC4AWPro");i||((i=document.createElement("iframe")).id="iFraC4AWPro",i.title="Click4Assistance Live Chat",i.style.display="none",i.allow="camera; microphone",i.setAttribute("AlignRight","true"),i.style.marginheight="0px",i.style.marginWidth="0px",i.style.borderWidth="0px",i.allowtransparency=!0,document.body.insertBefore(i,null),A.Log("Proactive.BuildiFrame()iFrame Created - proTool.W:"+t.W+" - proTool.H:"+t.H));i.style.cssText="border:0; z-index:2147483601; width:"+t.W+"px; height:"+t.H+"px;",i.style.height=t.H+"px",i.style.width=t.W+"px",i.style.display="none";var o="",o=S.DomainTI+"/"+S.GetPageName(t.TT)+"?AccGUID="+h+"&ExpGUID="+t.EGuid+"&ToolType="+t.TT+"&ChatGUID="+t.ChatGuid+"&ChatAccountGUID="+t.ChatAccountGuid+"&ImpType="+t.IT+"&ProactiveGUID="+t.PGUID+"&SessionProGUID="+t.SPGUID+"&SID="+v.Data.SID+"&RSound="+e;null!=c&&(o+="&"+c),null!=u&&(o+="&PushD="+u),null!=d&&(o+="&CustomDataGuid="+d);try{var n=null==h?null:h.toUpperCase();null==h||"01DCDED4-D168-4D22-AB4B-D073501B8353"!=n&&"05E4E0A8-61D3-41CC-8454-3B2425F643C8"!=n&&"3A7ADAFD-9926-4503-BB98-E3BB2B04DC7B"!=n&&"19DF1B3D-4155-41DA-A3C4-017C88422BCF"!=n&&"BCDB368E-7FDB-4C67-BA90-27BF237F1002"!=n||(n=document.location.href,m.IsUrlXSS(n)?o+="&OpenedFromFullPageUrl=XSS":o+="&OpenedFromFullPageUrl="+encodeURIComponent(n))}catch(t){A.Log("Proactive.BuildiFrame() - OpenedFromFullPageUrl _iFra:"+i.id+" - url:"+o)}return i.src=o,A.Log("Proactive.BuildiFrame()iFrame src:"+i.src),i},this.StopProactiveTimer=function(){null!=e&&(clearInterval(e),e=null),A.Log("Proactive.StopProactiveTimer() Stopped")},this.Issue=function(e,i){if(A.StartGroup("Proactive.Issue()"),r++,A.Log("Proactive.Issue() _proIssueCount: "+r),e.Issued=1,e.Dis=!0,e.NextCheckUTC=Math.floor((new Date).getTime()/1e3)+60*e.EM,i.S="ISSUED",1==e.ESAR&&(A.Log("Proactive.Issue() Proactive has been issued and we need to stop all other proactives being issued - VOID all rules and stop timer"),I()),v.Write(),e.Dis=!1,v.Write(),2==e.IT||4==e.IT||5==e.IT){if(3<=r)return A.Log("Proactive.Issue.DisplayIssuedProactive() ERROR - _proIssueCount >= 3, abort showing proactive & stop proactive timer"),void C4A.Proactive.StopProactiveTimer();var t,o,n,a=0==e.Rules[0].RT;e.SPGUID,t=e.EGuid,o=e.TT,n=a,a=function(t){if(3<=r)return A.Log("Proactive.Issue.DisplayIssuedProactive() ERROR - _proIssueCount >= 3, abort showing proactive & stop proactive timer"),void C4A.Proactive.StopProactiveTimer();e.SPGUID=t,v.Write(),(s=T.BuildiFrame(e,i.RS)).onload=function(){null==l&&(l=new C4A.Animation),l.Initilize(s,e.H,e.W,0,e.GO),l.Animate(e.AId),s.onload=null}},n="SessionGUID="+v.Data.SID+"&ExperienceGUID="+t+"&ToolType="+o+"&IsManualPush="+n,A.Log("Proactive.SetIssuedOn()Sending data:"+n),!void S.CreateProactiveSession(a,n),A.EndGroup()}else A.Log("Proactive.Issue() ERROR - Invalid Implementation Type for Proactive (can only be a 2,4,5)")}},A=new function(){"use strict";function l(t){var e,i;null!=t&&(i=e="",1<=(t=t.split("()")).length&&(e=t[0]),2<=t.length&&(i=t[1]),"Comms.SendToServer"==e&&0<i.indexOf("HeartBeat")||(t=document.getElementById("debugDiv"))&&(t.innerHTML+="<div style='color: grey;'>"+e+"</div><div style='margin-left: 20px;'>"+i+"</div>"))}this.Data=[],this.DisplayPanel=function(){var t=document.createElement("div");t.setAttribute("style",'background-color: #f5f5f5; border: 1px solid #ccc; box-sizing: border-box; font-family: "Consolas"; width: 100%;');var e=document.createElement("div");e.setAttribute("style","background-color: #ccc; box-sizing: border-box; color: #000; font-size: 16px; font-weight: 700; padding: 8px;"),e.innerHTML="Debugging";var i=document.createElement("button");i.innerHTML="Session",i.onclick=function(){var t=document.getElementById("lblSession");t&&(t.innerText=C4A.SessionData())};var o=document.createElement("div");o.id="lblSession";var n=document.createElement("button");n.innerHTML="Persist",n.onclick=function(){var t=document.getElementById("lblPersist");t&&(t.innerText=C4A.PersistData())};var a=document.createElement("div");a.id="lblPersist";var s=document.createElement("div");s.id="debugDiv",s.setAttribute("style","border-top: 1px solid #ccc; box-sizing: border-box; font-size: 14px; overflow-wrap: anywhere; padding: 16px;"),t.appendChild(e),t.appendChild(i),t.appendChild(o),t.appendChild(n),t.appendChild(a),t.appendChild(s),document.body.appendChild(t);for(var r=0;r<this.Data.length;r++)l(this.Data[r])},this.Log=function(t){null!=t&&(500<this.Data.length&&(this.Data=[]),this.Data.push(t),document.getElementById("debugDiv")&&l(t))},this.StartGroup=function(t){0},this.EndGroup=function(){0}};return{Run:function(t){!function(t){try{if(A.Log("Run()"),"9dc8a701-9196-481f-9797-b573fb1b165f"==t.toLowerCase()||"8958cd1d-e888-4739-96ee-870e099c9e28"==t.toLowerCase()||"30fef422-b802-4eb1-ad51-694c6d6bed22"==t.toLowerCase()||"bec36ef0-53b0-45e5-8e6a-6f9765a1abc6"==t.toLowerCase()||"09c15c40-a8e9-4be3-821d-88ad40a37174"==t.toLowerCase())return alert("Your C4A account has been removed, please remove all C4A scripts from your website.");if(null!=document.referrer&&-1<document.referrer.toUpperCase().indexOf(S.DomainTI.toUpperCase())&&(A.Log("Run() - Referred by the ToolInterface - Clearing Session"),window.sessionStorage.clear()),A.Log("Run() - sessionStorage:"+(window.sessionStorage?"True":"False")),-1<location.href.toUpperCase().indexOf("C4ADONTTRACK=Y"))return;var e=null==(h=t)?null:h.toUpperCase();if(null==h||"01DCDED4-D168-4D22-AB4B-D073501B8353"!=e&&"05E4E0A8-61D3-41CC-8454-3B2425F643C8"!=e&&"3A7ADAFD-9926-4503-BB98-E3BB2B04DC7B"!=e&&"19DF1B3D-4155-41DA-A3C4-017C88422BCF"!=e&&"BCDB368E-7FDB-4C67-BA90-27BF237F1002"!=e||(e=document.location.href,m.IsUrlXSS(e)||(v.Data.PageEntryURL=encodeURIComponent(e))),v.Read(),null!=v.Data.AccountGuid&&v.Data.AccountGuid.toUpperCase()!=t.toUpperCase()&&(A.Log("Run() - AccountGuid is different to the one in the Session object - ResetData()"),v.ResetData()),!v.Data.Active)return A.Log("Run - Account not enabled"),m.UIShowWarning("Your Account is not enabled");""==v.Data.SCook&&(v.Data.SCook=!!v.TestCookie()),""==v.Data.PCook&&(v.Data.PCook=!!r.TestCookie()),window.addEventListener?addEventListener("message",C4A.Comms.CB_ReceivePostMessage,!1):attachEvent("onmessage",C4A.Comms.CB_ReceivePostMessage);var i,o=!1;for(tCount=0;tCount<l.length;tCount++){for(var n in v.Data.Tools)v.Data.Tools[n].ScriptID==l[tCount].ScriptID&&(o=!0);o||(i={ScriptID:l[tCount].ScriptID,ToolType:0,ImpType:0,Height:0,Width:0,Displayed:!1,ChatGuid:null,ChatAccountGuid:null,ExpGuid:null},v.Data.Tools.push(i),v.Data.ReqTool=!0,v.Write())}if(l.length!=v.Data.Tools.length&&A.Log("Run()ERROR - Tools array does not match Tools collection"),A.Log("Run()Tools loaded"),null==v.Data.SID&&1==v.Data.PCook&&r.Read(),A.Log("Run()Persist.PID:"+r.Data.PID),!p.Enabled)return A.Log("Run - Tracking not enabled (set by script)"),S.CB_Initilize();if(!v.Data.IsActiveTracking)return A.Log("Run - Tracking not enabled (set by server)"),S.CB_Initilize();S.SendToServer("/PageHit/",v.URL()),A.Log("Run()Page Hit Registered")}catch(t){A.Log("EXCEPTION()<b style='color:red;'>EXCEPTION<b>:<br>"+t.stack)}}(t)},Track:p,Tools:function(t,e){return this.ScriptID=t,tool=new i(t,e),l.push(tool),tool;function i(t,e){var i=null,o=null,n=null,a=[];this.ScriptID=t,this.MyElementID=e,this.OpenNewTabOnWidth=320,this.Button=new s(this),this.Widget=new r(this),this.ExcludeUrl=function(t){a.push(t)},this.IsExcludeUrl=function(){var t,e=document.location.href.toLowerCase();for(t in a)if(-1!=e.indexOf(a[t]))return A.Log("Tools.Tool.IsExcludeUrl()Page is an excluded url"),!0;return!1},this.AddUrlData=function(t){o=t},this.GetUrlData=function(){return o},this.AddCustomData=function(t){t=(i=t).toLowerCase().indexOf("&");-1!=t&&(i=i.replace(/&/g,"%26")),-1!=(t=i.indexOf("?"))&&(i=i.replace(/\?/g,"%3F"))},this.GetCustomData=function(){return i},this.AddCustomDataGuid=function(t){n=t},this.GetCustomDataGuid=function(){return n}}function s(t){var r=t;this.MobileScreenWidth=480,this.FixedUrl=null,this.btnC4A=document.getElementById("C4A_btn"+r.ScriptID),this.btnZIndex=2147483598,this.DesktopCss="position:fixed; bottom:0; right:0; z-index:"+this.btnZIndex,this.MobileCss="position:fixed; bottom:8px; right:8px; z-index:"+this.btnZIndex,this.WrapInLink=!0,this.BtnAltTag="Live Chat Software Click4Assistance";var l=document.location.href,l=m.IsUrlXSS(l)?"":(l=l.split("?")[0],encodeURIComponent(l));this.Render=function(){0==m.IsDeviceCompatibleForTools()||9999==r.ScriptID||r.IsExcludeUrl()||(A.Log("Button.Render()"),A.Log("Button.Render()Browser width:"+m.UIGetWindowHeightWidth().Width),A.Log("Button.Render()OpenNewTabOnWidth:"+r.OpenNewTabOnWidth),null!=r.MyElementID&&void 0!==r.MyElementID&&this.RenderForExistingElement(),this.btnC4A||null!=r.MyElementID&&void 0!==r.MyElementID||this.RenderNewC4AButton())},this.RenderForExistingElement=function(){A.Log("Button.Render()Attempt to configure existing button");var t,e,i,o,n=this.MobileScreenWidth>=m.UIGetWindowHeightWidth().Width,a=v.GetToolByScriptOrExperience(r.ScriptID,r.ExpGuid),s=document.getElementById(r.MyElementID);s&&(s.style.zIndex=this.btnZIndex,s.onmouseover=function(){this.style.cursor="pointer"},s.onmouseout=function(){this.style.cursor="default"},s.onkeypress=function(t){13==t.keyCode&&this.click()},1==a.ImpType||r.OpenNewTabOnWidth>=m.UIGetWindowHeightWidth().Width||m.IsDeviceiPhone()?(t=0!=a.ToolType?a.ToolType:1,o=S.DomainTI+"/"+S.GetPageName(t)+"?AccGUID="+h+"&ScriptID="+r.ScriptID+"&ExpGUID="+a.ExpGuid+"&ToolType="+t+"&SID="+v.Data.SID,e=r.GetUrlData(),i=r.GetCustomDataGuid(),null!=e&&(o+="&"+e),o+="&PushD="+r.GetCustomData(),null!=i&&(o+="&CustomDataGuid="+i),s.setAttribute("c4a_Url",o),s.setAttribute("c4a_Name",t),s.onclick=function(){var t=this.getAttribute("c4a_Url"),e=this.getAttribute("c4a_Name"),i="";isNaN(a.Height)||(i+="height="+a.Height+","),isNaN(a.Width)||(i+="width="+a.Width);i="menubar=no,location=no,resizable=no,scrollbars=auto,status=no,"+i;return window.open(t,e,i),!1}):s.onclick=function(){r.Widget.Open()},o=null!=this.FixedUrl?this.FixedUrl:S.DomainSI+"/Button?strAccGUID="+h+"&strScriptID="+r.ScriptID+"&strIsMobile="+n+"&strPageUrl="+l,"IMG"==s.nodeName?s.src=o:(s.style.backgroundSize="contain",s.style.backgroundImage="url('"+o+"')"))},this.RenderNewC4AButton=function(){A.Log("Button.Render()Attempt to create our own button");var t=this.MobileScreenWidth>=m.UIGetWindowHeightWidth().Width,a=v.GetToolByScriptOrExperience(r.ScriptID,r.ExpGuid),e=null;this.btnC4A=document.createElement("img"),this.btnC4A.id="C4A_btn"+r.ScriptID,this.btnC4A.setAttribute("alt",this.BtnAltTag),this.btnC4A.onkeypress=function(t){13==t.keyCode&&this.click()},1==this.WrapInLink?((e=document.createElement("a")).setAttribute("id","C4A_lnk"+r.ScriptID),e.setAttribute("title",this.BtnAltTag),e.setAttribute("tabindex","0"),e.setAttribute("role","button"),e.onclick=function(t){document.getElementById("C4A_btn"+r.ScriptID).click()},e.onkeypress=function(t){13==t.keyCode&&document.getElementById("C4A_btn"+r.ScriptID).click()},e.onmouseover=function(){this.style.cursor="pointer"},e.onmouseout=function(){this.style.cursor="default"},e.style.zIndex=this.btnZIndex,e.style.cssText=(1==t?this.MobileCss:this.DesktopCss)+";line-height:0;"):(this.btnC4A.setAttribute("role","button"),this.btnC4A.setAttribute("tabindex","0"),this.btnC4A.setAttribute("title",this.BtnAltTag),this.btnC4A.onmouseover=function(){this.style.cursor="pointer"},this.btnC4A.onmouseout=function(){this.style.cursor="default"},this.btnC4A.style.zIndex=this.btnZIndex,this.btnC4A.style.cssText=1==t?this.MobileCss:this.DesktopCss),1==a.ImpType||r.OpenNewTabOnWidth>=m.UIGetWindowHeightWidth().Width||m.IsDeviceiPhone()?this.btnC4A.onclick=function(){var t=0!=a.ToolType?a.ToolType:1,e=S.DomainTI+"/"+S.GetPageName(t)+"?AccGUID="+h+"&ScriptID="+r.ScriptID+"&ExpGUID="+a.ExpGuid+"&ToolType="+t+"&SID="+v.Data.SID,i=r.GetUrlData(),o=r.GetCustomDataGuid();null!=i&&(e+="&"+i),e+="&PushD="+r.GetCustomData(),null!=o&&(e+="&CustomDataGuid="+o);try{var n=h.toUpperCase();null==h||"01DCDED4-D168-4D22-AB4B-D073501B8353"!=n&&"05E4E0A8-61D3-41CC-8454-3B2425F643C8"!=n&&"3A7ADAFD-9926-4503-BB98-E3BB2B04DC7B"!=n&&"19DF1B3D-4155-41DA-A3C4-017C88422BCF"!=n&&"BCDB368E-7FDB-4C67-BA90-27BF237F1002"!=n||(n=document.location.href,m.IsUrlXSS(n)?e+="&OpenedFromFullPageUrl=XSS":e+="&OpenedFromFullPageUrl="+encodeURIComponent(n))}catch(t){A.Log("Button.Render() - OpenedFromFullPageUrl _iFra:"+_iFra.id+" - url:"+e)}/^((?!chrome|android|crios|fxios).)*safari/i.test(navigator.userAgent)?window.open(e,t,"menubar=no,location=no,resizable=no,scrollbars=auto,status=no"):(o="menubar=no,location=no,resizable=no,scrollbars=auto,status=no,height="+a.Height+",width="+a.Width,window.open(e,t,o))}:this.btnC4A.onclick=function(){var t,e,i,o;C4A.iOSFix&&(t=-1!=navigator.userAgent.indexOf("iPhone"),e=-1!=navigator.userAgent.indexOf("iPod"),i=-1!=navigator.userAgent.indexOf("iPad"),(t||e||i)&&(A.Log("SI - iOS device detected"),0<document.querySelectorAll('meta[name="viewport"]').length||(A.Log("SI - Meta viewport added for iOS device"),(o=document.createElement("meta")).id="viewport",o.name="viewport",o.content="initial-scale = 1.0,maximum-scale = 1.0",document.getElementsByTagName("head")[0].appendChild(o)),i="html,body { -webkit-overflow-scrolling : touch !important; overflow: auto !important; height: 100% !important;}",(o=document.createElement("style")).stylesheet?o.stylesheet.csstext=i:o.appendChild(document.createTextNode(i)),document.getElementsByTagName("head")[0].appendChild(o),A.Log("SI - css added for iOS device"))),r.Widget.Open()};var i=null!=this.FixedUrl?this.FixedUrl:S.DomainSI+"/Button?strAccGUID="+h+"&strScriptID="+r.ScriptID+"&strIsMobile="+t+"&strPageUrl="+l;this.btnC4A.src=i,1==this.WrapInLink?(e.insertBefore(this.btnC4A,null),document.body.insertBefore(e,null)):document.body.insertBefore(this.btnC4A,null),A.Log("Button.Render()Added to body: "+this.btnC4A.id+"... CSS: "+this.btnC4A.style.cssText+", isMobile:"+t+" , src:+"+this.btnC4A.src)}}function r(e){var a=e,s=350,r=350,l=document.getElementById("iFraC4AW"+a.ScriptID);this.Css="position:fixed; right:0; bottom:0; z-index:2147483599; border:0; ",this.AlignRight=!0,this._animat=null,this.Animation=function(){return null==this._animat&&(this._animat=new C4A.Animation),this._animat},this.Render=function(){var t;A.Log("Widget.Render()"),A.Log("Widget.Render()Css:"+this.Css),l||(t=v.GetToolByScriptOrExperience(e.ScriptID,e.ExpGuid),s=t.Width,r=t.Height,(l=document.createElement("iframe")).id="iFraC4AW"+a.ScriptID,l.title="Click4Assistance Live Chat",l.style.cssText=this.Css+";width:"+s+"px; height:"+r+"px;",l.style.display="none",l.allow="camera; microphone",l.style.marginheight="0px",l.style.marginWidth="0px",l.style.borderWidth="0px",l.allowtransparency=!0,l.setAttribute("AlignRight",this.AlignRight),document.body.insertBefore(l,null))},this.Open=function(t,e){if(A.Log("Widget.Open()"),!a.IsExcludeUrl()){null!=a.Button.btnC4A&&(a.Button.btnC4A.style.display="none"),void 0===e&&(e=!1),A.Log("Widget.Open() - IsCallback:"+e),A.Log("Widget.Open() - ScriptID:"+a.ScriptID+" - ExpGuid:"+a.ExpGuid);var i=v.GetToolByScriptOrExperience(a.ScriptID,a.ExpGuid);if(0==e&&(null==i.ExpGuid||0==i.ExpGuid.length))return v.Write(),void S.SendToServer("/ToolData/",v.URL()+"&ScriptID="+i.ScriptID);i.Displayed=!0,v.Write();var o,n=S.DomainTI+"/"+S.GetPageName(i.ToolType)+"?AccGUID="+h+"&ScriptID="+i.ScriptID+"&ExpGUID="+i.ExpGuid+"&ToolType="+i.ToolType+"&ChatGUID="+i.ChatGuid+"&ChatAccountGUID="+i.ChatAccountGuid+"&SID="+v.Data.SID;void 0!==t&&(n+="&ThisFormType="+t),null!=a.GetUrlData()&&(n+="&"+a.GetUrlData()),n+="&PushD="+a.GetCustomData(),null!=a.GetCustomDataGuid()&&(n+="&CustomDataGuid="+a.GetCustomDataGuid());try{null==h||"01DCDED4-D168-4D22-AB4B-D073501B8353"!=h.toUpperCase()&&"05E4E0A8-61D3-41CC-8454-3B2425F643C8"!=h.toUpperCase()&&"3A7ADAFD-9926-4503-BB98-E3BB2B04DC7B"!=h.toUpperCase()&&"19DF1B3D-4155-41DA-A3C4-017C88422BCF"!=h.toUpperCase()&&"BCDB368E-7FDB-4C67-BA90-27BF237F1002"!=h.toUpperCase()||(o=document.location.href,m.IsUrlXSS(o)?n+="&OpenedFromFullPageUrl=XSS":n+="&OpenedFromFullPageUrl="+encodeURIComponent(o))}catch(t){A.Log("Widget.Open() - OpenedFromFullPageUrl _iFra:"+l.id+" - src:"+n)}A.Log("Widget.Open()_iFra:"+l.id+" - src:"+n),l.setAttribute("RealSrc",n),l.src=l.getAttribute("RealSrc")+"&Rnd="+Math.random();e=this.Animation(),t="";null!=a.Button.btnC4A&&(t=(document.getElementById("C4A_lnk"+i.ScriptID)||a.Button.btnC4A).style.top),e.Initilize(l,r,s,t,!1),e.ScriptId=i.ScriptID,1==i.ToolType||2==i.ToolType?i.ChatGuid?(A.Log("Widget.Open() - Animate(4)"),e.Animate(4)):S.SendToServer("/AnimatePreDialogWindow/","ExpGuid="+i.ExpGuid+"&ScriptID="+i.ScriptID+"&Top="+t):(A.Log("Widget.Open() - Animate(5)"),e.Animate(5)),c.push(e)}},this.Close=function(t){A.Log("Widget.Close()"),null!=a.Button.btnC4A&&(a.Button.btnC4A.style.display="block"),A.Log("Widget.Close() No of Animations Before :"+c.length);for(var e=999,i=0;i<c.length;i++){A.Log("Widget.Close() Looping - Idx:"+i);var o=c[i];o.ScriptId==a.ScriptID&&(e=i,A.Log("Widget.Close() animat.ScriptId:"+o.ScriptId),o.Close(a.ScriptID,t))}999!=e&&c.splice(e,1),A.Log("Widget.Close() No of Animations After:"+c.length),v.GetToolByScriptOrExperience(a.ScriptID,a.ExpGuid).Displayed=!1,v.Write()}}},Conversion:u,Prospect:d,Comms:S,Proactive:T,ClearSessionData:ClearSessionData,PersistData:PersistData,SessionData:SessionData,Animation:function(){var l=null,c=0,u=0,d=0,h=!1,p=!1,C=null;function s(){l.style.top=0,l.style.left=0,l.style.position="absolute",l.style.height=c,l.style.width=u,l.style.bottom=0,l.style.right=0,l.style.display="none",h=!1;var t=void 0!==l.style.opacity,e=!t&&void 0!==l.style.filter;t&&(l.style.opacity=parseFloat(1)),e&&(l.style.filter="alpha(opacity=100)"),l.style.MozOpacity=parseFloat(1)}function g(t,e,i,o){return i*((t=t/o-1)*t*t*t*t+1)+e}this.ScriptId=0,this.Initilize=function(t,e,i,o,n){d=o,c=e,u=i,(l=t).style.height=c+"px",l.style.width=u+"px",h=!1,p=n},this.Close=function(t,e){var i,o,n,a;t&&(l=document.getElementById("iFraC4AW"+t)),l&&(null!=C&&clearInterval(C),i=c,o=(new Date).getTime(),a=n=0,C=setInterval(function(){n=(new Date).getTime()-o,a=g(n,i,0-i,1e3),l.style.height=a+"px",1e3<=n&&(s(),clearInterval(C))},1e3/60),this.GreyOutHide(),A.Log("Animation.Close() setting blank src for iframe id: "+l.id+" original src:"+l.src),e||(l.src="about:blank"))},this.GreyOutHide=function(){var t=document.getElementById("C4A_divGreyOut");t&&document.body.removeChild(t),s()},this.GreyOutShow=function(){var t=document.body,e=document.documentElement,i=Math.max(t.scrollWidth,t.offsetWidth,e.clientWidth,e.scrollWidth,e.offsetWidth),t=Math.max(t.scrollHeight,t.offsetHeight,e.clientHeight,e.scrollHeight,e.offsetHeight),e=document.getElementById("C4A_divGreyOut");e||((e=document.createElement("div")).id="C4A_divGreyOut",e.setAttribute("style","position:absolute; top:0; left:0;width:"+i+"px; height:"+t+'px; z-index:2147483600; background-color: rgba(0, 0, 0, 0.8); -ms-filter: "progid:DXImageTransform.Microsoft.Alpha(Opacity=80)";background-color: #000000\\0/;  '),document.body.appendChild(e),e.addEventListener?e.addEventListener("click",C4A.Animation.GreyOutHide,!1):e.attachEvent?e.attachEvent("onclick",C4A.Animation.GreyOutHide):e.onclick=C4A.Animation.GreyOutHide)},this.Animate=function(t){var e,i,o,n,a,s,r;l&&(e=function(t,e,i){var o=0,n=0,a=0,s=0,r=m.UIGetWindowHeightWidth(),l=m.UIGetScrollPosition();1==t&&(o=r.Height/2-e/2+l.TopOffset,n=r.Width/2-i/2+l.LeftOffset,a=o,s=n);2==t&&(o=r.Height/2-e/2+l.TopOffset,n=0-i+l.LeftOffset,a=o,s=r.Width/2-i/2+l.LeftOffset);3==t&&(o=0-e+l.TopOffset,n=r.Width-i+l.LeftOffset,a=r.Height-e+l.TopOffset,s=n);4==t&&(o=r.Height+e+l.TopOffset,n=r.Width-i+l.LeftOffset,a=r.Height-e+l.TopOffset,s=n);6==t&&(o=r.Height/2-e/2+l.TopOffset,n=r.Width+i+l.LeftOffset,a=o,s=r.Width/2-i/2+l.LeftOffset);l=new Array;return l.StartTop=o,l.StartLeft=n,l.StopTop=a,l.StopLeft=s,l}(t,c,u),n=o=i=0,a=(new Date).getTime(),h||(p?this.GreyOutShow():this.GreyOutHide(),h=!0,1==t&&(l.style.top=e.StopTop+"px",l.style.left=e.StopLeft+"px",l.style.height=c+"px",l.style.width=u+"px",l.style.position="absolute",l.style.display="none",i=e.StartLeft,o=e.StopLeft,s=0,r=setInterval(function(){var t,e;h?(e=!(t=void 0!==l.style.opacity)&&void 0!==l.style.filter,t&&(l.style.opacity=parseFloat(s/100)),e&&(l.style.filter="alpha(opacity="+s+")"),l.style.MozOpacity=parseFloat(s/100),s++,l.style.display="block",100<=s&&(h=!1,clearInterval(r))):clearInterval(r)},1e3/60)),2==t&&(l.style.display="block",l.style.top=e.StartTop+"px",l.style.left=e.StartLeft+"px",l.style.height=c+"px",l.style.width=u+"px",l.style.position="absolute",l.style.bottom="",l.style.right="",i=e.StartLeft,o=e.StopLeft,n=2e3,r=setInterval(function(){var t,e;h?(e=g(t=(new Date).getTime()-a,i,o-i,n),l.style.left=e+"px",(n<=t||!h)&&(h=!1,clearInterval(r))):clearInterval(r)},1e3/60)),3==t&&(l.style.display="block",l.style.top=e.StartTop+"px",l.style.left="",l.style.height=c+"px",l.style.width=u+"px",l.style.bottom="0",l.style.right="0",l.style.position="absolute",i=e.StartTop,o=e.StopTop,n=2e3,r=setInterval(function(){var t,e;h?(e=g(t=(new Date).getTime()-a,i,o-i,n),l.style.top=e+"px",(n<=t||!h)&&(l.style.bottom="0",l.style.right="0",l.style.position="fixed",l.style.top="",h=!1,clearInterval(r))):clearInterval(r)},1e3/60)),4==t&&(l.style.display="block",l.style.position="fixed",l.style.height="0",l.style.width=u+"px","true"==l.getAttribute("AlignRight")?(l.style.left="",l.style.right="0"):(l.style.left="0",l.style.right=""),l.style.bottom="0",l.style.top="",i=0,o=c,n=2e3,null!=C&&clearInterval(C),C=setInterval(function(){var t,e;h?(e=g(t=(new Date).getTime()-a,i,o-i,n),l.style.height=e+"px",(n<=t||!h)&&(l.style.display="block",h=!1,clearInterval(C))):clearInterval(C)},1e3/60)),5==t&&(l.style.display="block",l.style.top=d,l.style.left="0px",l.style.height=c+"px",l.style.width="0px",l.style.position="fixed",l.style.bottom="",l.style.right="",i=0,o=u,n=1e3,null!=C&&clearInterval(C),C=setInterval(function(){var t,e;h?(A.Log("Animation:Animate:_iFra.id"+l.id),e=g(t=(new Date).getTime()-a,i,o-i,n),l.style.width=e+"px",(n<=t||!h)&&(h=!1,clearInterval(C))):clearInterval(C)},1e3/60)),6==t&&(l.style.display="block",l.style.top=e.StartTop+"px",l.style.right=-u+"px",l.style.height=c+"px",l.style.width=u+"px",l.style.position="fixed",l.style.bottom="",l.style.left="",i=e.StartLeft,o=e.StopLeft,n=2e3,r=setInterval(function(){var t,e;h?(e=g(t=(new Date).getTime()-a,i,o-i,n),l.style.left=e+"px",(n<=t||!h)&&(h=!1,clearInterval(r),l.style.position="absolute")):(clearInterval(r),l.style.position="absolute")},1e3/60))))}},Debug:A,iOSFix:iOSFix}}();C4ALoaded?console.warn("Click4Assistance C4A.Run() called multiple times, potentially duplicate C4A script on web page."):InitialiseC4A();