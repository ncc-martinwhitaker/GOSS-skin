function InitialiseC4A() {

    // Every Chat Experience used below must be a popup (not embedded)
    // The varible below must match the id of the img used for the chat button

    var ChatImgId = 'customLiveChatButton';

    /*// Norfolk test
    if (
        location.href.toLowerCase().indexOf("norfolk.ncc1-tst.gosshosted.com/24771") != -1
    ) {
        var myChatTool = new C4A.Tools(1, ChatImgId);
        C4A.Run('EE7B45EB-6AE4-4647-9D78-C180455DFAFE');
    }*/

    // NCC ScriptID=1 (Norfolk CC-Chat Experience)
    if (
        location.href.toLowerCase().indexOf("/42566") != -1 ||
        location.href.toLowerCase().indexOf("/42578") != -1 ||
        location.href.toLowerCase().indexOf("/42570") != -1 ||
        location.href.toLowerCase().indexOf("/42580") != -1 ||
        location.href.toLowerCase().indexOf("/42583") != -1 ||
        location.href.toLowerCase().indexOf("/41984") != -1 ||
        location.href.toLowerCase().indexOf("/38796") != -1
    ) {
        var myChatTool = new C4A.Tools(1, ChatImgId);
        C4A.Run('EE7B45EB-6AE4-4647-9D78-C180455DFAFE');
    }

    // NCC ScriptID=2 (TRAINING Experience)

    // NCC ScriptID=3 (Blue Badge Experience)
    if (
        location.href.toLowerCase().indexOf("/39800") != -1 ||
        location.href.toLowerCase().indexOf("/41932") != -1 ||
        location.href.toLowerCase().indexOf("/39802") != -1
    ) {
        var myChatTool = new C4A.Tools(3, ChatImgId);
        C4A.Run('EE7B45EB-6AE4-4647-9D78-C180455DFAFE');
    }

    // NCC Script=4 (General Enquiries)
    if (
        location.href.toLowerCase().indexOf("/38292") != -1 ||
        location.href.toLowerCase().indexOf("/38294") != -1 
    ) {
        var myChatTool = new C4A.Tools(4, ChatImgId);
        C4A.Run('EE7B45EB-6AE4-4647-9D78-C180455DFAFE');
    }

    // NCC Script=5 (Chatbot test)

    // Finance ScriptID=1
    if (
        location.href.toLowerCase().indexOf("/41982") != -1 ||
        location.href.toLowerCase().indexOf("/41983") != -1
    ) {
        var myChatTool = new C4A.Tools(1, ChatImgId);
        C4A.Run('4ff484de-0b0d-4c01-8a74-278d96d4182f');
    }
}
	
//<script src="https://v4in1-si.click4assistance.co.uk/SI.js" type="text/javascript" defer="defer"></script>

//console.log("SI - 080823");
"use strict";console.log("SI - 260324");var C4ALoaded=void 0!==(C4A=C4A||{}).Run,C4A=void 0!==C4A.Run?C4A:function(){var h=null,l=[],c=[],v=new function(){var a="_C4AS",e=function(){try{var e=window.location.hostname.toUpperCase();return-1==window.location.href.toUpperCase().indexOf(e)?"Unknown Domain":e.toLowerCase()}catch(e){return"Unknown Domain"}}(),t=function(){try{return encodeURIComponent(document.location.href.split("?")[0])}catch(e){return"Unknown Url"}}();this.Data={AccountGuid:h,Active:!0,IsActiveTracking:!0,IsActiveProspect:!0,SCook:!1,PCook:!1,Access:"",SID:null,HSGUID:null,PageEntryURL:t,PageURL:"",SiteHitUTC:"",PageHitUTC:"",HBINT:0,HBTO:0,DebugIP:"",DebugShowUI:!1,IsPros:!1,IsProsMatchedMethod:0,HostName:e,ReqTool:!0,Tools:[],ProTools:[]},this.ResetData=function(){this.Data={AccountGuid:h,Active:!0,IsActiveTracking:!0,IsActiveProspect:!0,SCook:!1,PCook:!1,Access:"",SID:null,HSGUID:null,PageEntryURL:t,PageURL:"",SiteHitUTC:"",PageHitUTC:"",HBINT:0,HBTO:0,DebugIP:"",DebugShowUI:!1,IsPros:!1,IsProsMatchedMethod:0,HostName:e,ReqTool:!0,Tools:[],ProTools:[]}},this.GetToolByScriptOrExperience=function(e,t){for(var i in this.Data.Tools){var o=this.Data.Tools[i];if(0<e){if(o.ScriptID==e)return o}else if(null!=t&&o.ExpGuid==t)return o}},this.TestCookie=function(){return navigator.cookieEnabled},this.Read=function(){if(window.sessionStorage){var e=sessionStorage.getItem("SISession");A.Log("Session:Read:"+e),null!=e&&(this.Data=JSON.parse(e))}else for(var t=a+"=",i=document.cookie.split(";"),o=0;o<i.length;o++){for(var n=i[o];" "==n.charAt(0);)n=n.substring(1,n.length);0==n.indexOf(t)&&(this.Data=JSON.parse(n.substring(t.length,n.length)))}return null},this.Write=function(){var e=JSON.stringify(this.Data);if(!window.sessionStorage)return document.cookie=a+"="+e+";path=/;SameSite=None; Secure;",!0;sessionStorage.setItem("SISession",e),A.Log("Session:Write:"+e)},this.URL=function(){this.Data.PageURL=encodeURIComponent(document.location.href);var e=JSON.parse(JSON.stringify(this.Data));delete e.ProTools;e="SessionData="+JSON.stringify(e);return(e=(e=(e=(e=(e=(e=e+"&PName="+p.GetPageName())+"&Vis="+s.GetVisits())+"&LastVisUTC="+s.GetLastVisitUTC())+"&Refer="+encodeURIComponent(document.referrer))+"&PID="+s.Data.PID)+"&UnqVID="+p.UniqueVisitorID).length<1800&&(e=e+"&TPushD="+p.GetCustomData()),2e3<e.length&&(A.Log("Session:URL - 2000 Characters exceeded, can process page hit"),this.SendToServer("/LogToDbaseFromClient","Message=Session:URL - 2000 Characters exceeded, can process page hit&sourceLogCode=JS03")),e}},s=new function(){var i="_C4AP";this.Data={PID:"",MatchedMethod:0,LastVIUTC:"",Activity:[]},this.TestCookie=function(){return!!C4A.Track.UseCookie&&navigator.cookieEnabled},this.Read=function(){var e=window.localStorage||(window.globalStorage?globalStorage[location.hostname]:null);if(e){e=e.SIPersist;e&&(A.Log("Persist:Read:"+e),this.Data=JSON.parse(e))}else for(var t=document.cookie.split(";"),i=0;i<t.length;i++){for(var o=t[i];" "==o.charAt(0);)o=o.substring(1,o.length);0==o.indexOf("_C4AP=")&&(this.Data=JSON.parse(o.substring("_C4AP=".length,o.length)))}return null},this.Write=function(){if(!C4A.Track.UseCookie)return!1;var e=JSON.stringify(this.Data),t=window.localStorage||(window.globalStorage?globalStorage[location.hostname]:null);return t?(t.SIPersist=e,A.Log("Persist:Write:"+e)):document.cookie=i+"="+e+";SameSite=None; Secure; expires=Tue, 31 Dec 2030 00:00:00 UTC",!0},this.GetVisits=function(){for(var e=0,t=0;t<this.Data.Activity.length;t++)"VI"==this.Data.Activity[t].Type&&e++;return e},this.GetLastVisitUTC=function(){for(var e=this.Data.Activity.length-1;0<=e;e--)if("VI"==this.Data.Activity[e].Type)return this.Data.Activity[e].UTC;return null},this.AddActivity=function(e,t,i,o,n,a){A.Log("Persist.AddActivity()"),""!=e&&(this.Data.PID=e),""!=t&&(this.Data.LastVIUTC=t);a={UTC:i,Type:o,GUID:n,Other:a};10<=this.Data.Activity.length&&this.Data.Activity.shift(),s.Data.Activity.push(a),this.Write()},this.UpdatePID=function(e,t){null!=e&&(this.Data.PID=e),null!=t&&(this.Data.MatchedMethod=t),this.Write()}},p=new function(){var e=/<[^>]*>/g,t=null;this.Enabled=!0,this.UseCookie=!0,this.PageName=document.title.replace(e,"").replace("&","%26"),this.AllowProactives=!0,this.UniqueVisitorID=null,this.GetPageName=function(){return this.PageName=("string"==typeof this.PageName?this.PageName:document.title).replace(e,"").replace("&","%26")},this.AddCustomData=function(e){t=e},this.GetCustomData=function(){return t}},u=new function(){var o=null,n=null,a=null,t=null;this.Origin=null,this.UniqueVisitorID=null,this.AddOrder=function(e,t,i){o=e,n=t,a=i},this.AddCustomData=function(e){t=e},this.URL=function(){var e="";return e+="&PCook="+v.Data.PCook,e+="&SID="+v.Data.SID,e+="&DebugIP="+v.Data.DebugIP,e+="&PID="+s.Data.PID,e+="&PName="+p.GetPageName(),e+="&PUrl="+document.location.href,e+="&Vis="+s.GetVisits(),e+="&COrigin="+this.Origin,e+="&CUnqVID="+this.UniqueVisitorID,e+="&CCustomD="+t,e+="&COrdRef="+o,e+="&COrdVal="+n,e+="&COrdCur="+a}},d=new function(){var t=null;this.UniqueVisitorID=null,this.AddCustomData=function(e){t=e},this.GetCustomData=function(){return t},this.URL=function(){return"&PCook="+v.Data.PCook+"&SID="+v.Data.SID+"&DebugIP="+v.Data.DebugIP+"&PID="+s.Data.PID+"&PName="+p.GetPageName()+"&PUrl="+document.location.href+"&Vis="+s.GetVisits()+"&PUnqVID="+this.UniqueVisitorID+"&PCustomD="+t}},m=new function(){this.UIGetWindowHeightWidth=function(){var e=window,t=document,i=t.documentElement,o=t.getElementsByTagName("body")[0],t=e.innerWidth||i.clientWidth||o.clientWidth,i=e.innerHeight||i.clientHeight||o.clientHeight,o=new Array;return o.Height=i,o.Width=t,o},this.UIGetScrollPosition=function(){var e,t,i,o=new Array;return null!=window.pageYOffset?(o.TopOffset=pageYOffset,o.LeftOffset=pageXOffset):(e=(t=document).documentElement,i=t.body,t=e.scrollLeft||i.scrollLeft||0,i=e.scrollTop||i.scrollTop||0,o.TopOffset=i,o.LeftOffset=t),o},this.UIShowWarning=function(e){var t=document.createElement("div");t.id="C4A_divWarning",t.setAttribute("style","z-index:9999; background-color:red; border:2px solid white; height:160px; width:200px; padding:8px; position:fixed; bottom:0; right:0; color:white; font-family:Arial; font-size:12px;"),t.innerHTML="<strong style='margin-bottom:12px; display:block; font-size:14px;'>Warning</strong>"+e;var i=document.createElement("div");i.setAttribute("style","width:100%; background-color:white; height:1px; margin-bottom:4px;margin-top:12px;");e=document.createElement("div");e.innerHTML='Contact <a href="https://click4assistance.co.uk" target="_blank" title="Contact Click4Assistance" style="color:white;">Click4Assistance</a> support for help and advice.',t.appendChild(i),t.appendChild(e),document.body.appendChild(t)},this.IsDeviceCompatibleForTools=function(){try{var e=navigator.userAgent;if(null==e)return!1;var t=e.toLowerCase();if(0<t.indexOf("android")){for(var i,o,n=e.length,a=t.indexOf("android")+"android".length+1;a<n;++a){var r=e.chatCodeAt(a);if(!(48<=charcode&&charcode<=57||46==charcode)){i=a;break}}for(var s=0,a=i+1;a<n;++a)if(46==(r=e.chatCodeAt(a)))++s;else if(!(48<=r&&r<=57)){++o;break}var l=e.substr(i,o-i);return 2==s&&(t=l.lastIndexOf("."),l=l.substr(0,t)),!(parseInt(l)<5)||(A.Log("Android version is less than 5.0"),-1<l.indexOf("4.0")?(A.Log("Android version is 4.0"),!1):-1<l.indexOf("4.1")?(A.Log("Android version is 4.1"),!1):-1<l.indexOf("4.2")?(A.Log("Android version is 4.2"),!1):(A.Log("Android version is greater than 4.2"),!0))}return!0}catch(e){return!0}},this.IsDeviceiPhone=function(){return!1},this.IsUrlXSS=function(e){try{return 0<e.toLowerCase().indexOf("<script")?(A.Log("IsUrlXSS: "+e),!0):(0<e.toLowerCase().indexOf("<//script>")||0<e.toLowerCase().indexOf("%3c;script")||0<e.toLowerCase().indexOf("script%3e")||0<e.toLowerCase().indexOf("&lt;script")||0<e.toLowerCase().indexOf("javascript%3a"))&&(A.Log("IsUrlXSS: "+e),!0)}catch(e){return!1}},this.IsGuid=function(e){try{return null==e||""==e?!1:/^(\{){0,1}[0-9a-fA-F]{8}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{12}(\}){0,1}$/.test(e)}catch(e){return!0}}},T=new function(){var i=120,o=null,t=null,n=0,a=!1,r=null;this.DomainSI="https://v4in1-si.click4assistance.co.uk",this.DomainTI="https://v4in1-ti.click4assistance.co.uk",this.SendToServer=function(e,t){var i,o,n="C4A_ScriptSend";a||(null!=h&&""!=h?m.IsGuid(h)?(i=this.DomainSI+e+"?AccGUID="+h+"&"+t+"&"+Math.random(),A.Log("Comms.SendToServer() => "+i),e=(o=window.document).getElementsByTagName("head").item(0),(t=o.getElementById(n))&&e.removeChild(t),(o=o.createElement("script")).src=encodeURI(i),o.type="text/javascript",o.defer=!0,o.id=n,e.appendChild(o)):console.warn("SendToServer(): _accountGuid is an invalid guid"):console.warn("SendToServer(): _accountGuid is empty"))},this.StartHeartBeat=function(){var e;v||v.Data?0!=v.Data.Active&&(!isNaN(v.Data.HBINT)&&0!=v.Data.HBINT||(v.Data.HBINT=5),(isNaN(v.Data.HBTO)||0==v.Data.HBTO||10<=v.Data.HBTO)&&(v.Data.HBTO=5),i=60/v.Data.HBINT*v.Data.HBTO,o=(new Date).setMinutes((new Date).getMinutes()+v.Data.HBTO),e=1e3*v.Data.HBINT,A.Log("Comms.StartHeartBeat() => delay: "+e+"ms"),null!=t&&(clearInterval(t),A.Log("Comms.StartHeartBeat() - Heartbeat Timer cleared")),t=window.setInterval(T.SendHeartBeat,e)):A.Log("Comms.StartHeartBeat() - No Session or No Session.Data")},this.StopHeartBeat=function(){window.clearInterval(t),o=t=null,n=0,A.Log("Comms.StopHeartBeat()")},this.SendHeartBeat=function(){if(n++,null!=o)if(new Date>o)T.StopHeartBeat();else if(i<n)T.StopHeartBeat();else if(a)T.StopHeartBeat();else{if(!v&&!v.Data)return A.Log("Comms.SendHeartBeat() - No Session or No Session.Data"),void T.StopHeartBeat();var e,t=document.location.href;m.IsUrlXSS(t)?T.StopHeartBeat():(t=t.split("?")[0],t=encodeURIComponent(t),e="&Active="+v.Data.Active,e+="&Access="+v.Data.Access,e+="&SID="+v.Data.SID,e+="&DebugIP="+v.Data.DebugIP,e+="&PUrl="+t,T.SendToServer("/HeartBeat",e))}else T.StopHeartBeat()},this.GetPageName=function(e){switch(e){case 1:case 2:return"DefaultChat.aspx";case 3:return"DefaultSmartContact.aspx";case 4:return"DefaultClick2Call.aspx";case 5:return"DefaultMeetingRoom.aspx";case 6:return"DefaultPromotion.aspx";default:A.Log("Comms.GetPageName() => [INVALID TOOLTYPE] ToolType:"+e)}},this.CreateProactiveSession=function(e,t){r=e,T.SendToServer("/CreateProactiveSession",t)},this.CB_Initilize=function(){var t,e;v.Data.DebugShowUI&&C4A.Debug.DisplayPanel(),A.Log("Comms.CB_Initilize()"),A.Log("Comms.CB_Initilize() => There are "+(l?l.length:"0")+" (fixed tools) in the collection"),l&&l.forEach(function(e,t){A.Log("Comms.CB_Initilize() => Tool: "+(t+1)+" Rendering Button & Widget - ScriptId: "+e.ScriptID),e.Button.Render(),e.Widget.Render();var i=v.GetToolByScriptOrExperience(e.ScriptID,e.ExpGuid);i?(A.Log("Comms.CB_Initilize() => Tool: "+(t+1)+" - Displayed: "+i.Displayed),i.Displayed&&e.Widget.Open()):A.Log("Comms.CB_Initilize() => Unable to find tool using ScriptID: "+e.ScriptID+" OR ExpGuid:"+e.ExpGuid)}),A.Log("Comms.CB_Initilize() => There are "+(v.Data.ProTools?v.Data.ProTools.length:"ZERO")+" (proactive tools) in the collection"),v.Data.ProTools&&(t=!0,v.Data.ProTools.forEach(function(e){e.Dis&&-1<[1,2,4].indexOf(e.TT)&&(t=!1,A.Log("Comms.CB_Initilize() => The ProTool is set to be displayed - EGuid: "+e.EGuid),S.Issue(e,e.Rules[0]))}),t&&v.Data.ProTools.forEach(function(e){e.Dis&&(A.Log("Comms.CB_Initilize() => The ProTool is set to be displayed - EGuid: "+proTool.EGuid),S.Issue(e,e.Rules[0]))})),!0===v.Data.PCook&&s.Read(),!0===p.Enabled&&!0===v.Data.IsActiveTracking?(e=!1,null!==d.UniqueVisitorID&&!0===v.Data.Active&&"T"===v.Data.Access.substr(1,1)&&(A.Log("Comms.CB_Initilize() => Sending prospect data"),this.SendToServer("/AddProspect",d.URL()),e=!0),null!==d.UniqueVisitorID&&"F"===v.Data.Access.substr(1,1)&&(m.UIShowWarning("Prospect feature is disabled â€“ You must remove the prospect script to prevent this warning appearing."),this.SendToServer("/LogToDbaseFromClient","Message=A prospect was attempted to be added, but prospects are disabled&sourceLogCode=JS02")),null!=u.Origin&&"F"==v.Data.Access.substr(2,1)?(m.UIShowWarning("Conversion are Disabled â€“ you must remove the conversion script to prevent this warning appearing."),C4A.Comms.SendToServer("/LogToDbaseFromClient","Message=A conversion was attempted to be added, but conversions are disabled&sourceLogCode=JS01")):null!==u.Origin&&!0===v.Data.Active&&"T"===v.Data.Access.substr(2,1)&&(e?setTimeout(function(){A.Log("Comms.CB_Initilize() => Sending conversion data (with 1000ms delay)"),C4A.Comms.SendToServer("/AddConversion",u.URL())},1e3):(A.Log("Comms.CB_Initilize() => Sending conversion data"),C4A.Comms.SendToServer("/AddConversion",u.URL()))),v.Write(),T.StartHeartBeat(),S.Initilize()):A.Log("Comms.CB_Initilize() => Tracking not enabled - Prospects, Conversions, Heartbeat & Proactives not processed")},this.CB_DDosAttack=function(){A.Log("Comms.CB_DDosAttack()"),a=!0},this.CB_SessionWrite=function(e){var t,i,o;A.Log("Comms.CB_SessionWrite() => "+e),v||v.Data?(t=v.Data.PageURL,i=v.Data.SiteHitUTC,o=v.Data.PageHitUTC,v.Data=JSON.parse(e),v.Data.PageURL=t,v.Data.SiteHitUTC=i,v.Data.PageHitUTC=o,""===v.Data.SiteHitUTC&&(v.Data.SiteHitUTC=Math.floor((new Date).getTime()/1e3)),""===v.Data.PageHitUTC&&(v.Data.PageHitUTC=Math.floor((new Date).getTime()/1e3)),o=encodeURIComponent(document.location.href),v.Data.PageURL!==o&&(v.Data.PageURL=o,v.Data.PageHitUTC=Math.floor((new Date).getTime()/1e3)),v.Write(),v.Read()):A.Log("Comms.CB_SessionWrite() - No Session or No Session.Data")},this.CB_AddActivity=function(e,t,i,o,n,a){A.Log("Comms.CB_AddActivity() => "+e+" - "+t+" - "+i+" - "+o+" - "+n+" - "+a),s.AddActivity(e,t,i,o,n,a),s.Write(),s.Read()},this.CB_UpdatePID=function(e,t){A.Log("Comms.CB_UpdatePID() => pid: "+e+" - matchedMethod: "+t),v.Data.IsPros=!0,v.Data.IsProsMatchedMethod=t,v.Write(),v.Read(),s.UpdatePID(e,t),s.Write(),s.Read()},this.CB_RequestPersistentCookie=function(){var e;A.Log("Comms.CB_RequestPersistentCookie()"),!1!==v.Data.IsActiveTracking&&null!==v.Data.SID&&"null"!==v.Data.SID&&(s.Read(),e="SID="+v.Data.SID+"&PersistData="+JSON.stringify(s.Data),T.SendToServer("/AcceptPersistentData/",e))},this.CB_UIShowWarning=function(e){A.Log("Comms.CB_UIShowWarning() => "+e),m.UIShowWarning(e)},this.CB_AnimatePreDialogWindow=function(e,t,i,o){var n,a=document.getElementById("iFraC4AW"+o);a?(n=null,l&&l.forEach(function(e){e.ScriptID==o&&(n=e.Widget?e.Widget.Animation():null)}),n?(n.Initilize(a,e,t,i,!1),n.ScriptId=o,A.Log("Comms.CB_AnimatePreDialogWindow() => Animate(4)"),n.Animate(4)):A.Log("Comms.CB_AnimatePreDialogWindow() => Tool / Animation not found for script id: "+o)):A.Log("Comms.CB_AnimatePreDialogWindow() => iFraC4AW iframe not found for script id:"+o)},this.CB_ResizeWindow=function(t,i,o,n){var a=document.getElementById("iFraC4AW"+o);a?v.Data.Tools&&v.Data.Tools.forEach(function(e){e.ScriptID!=o||e.Width==t&&e.Height==i||(a.style.width=t+"px",a.style.height=i+"px",(e=v.GetToolByScriptOrExperience(o,n)).Width=t,e.Height=i,v.Write())}):A.Log("Comms.CB_ResizeWindow() iFraC4AW iframe not found for script id:"+o)},this.CB_ResizeWindowWithAnimation=function(s,l,c,u){var d=document.getElementById("iFraC4AW"+c);d?v.Data.Tools&&v.Data.Tools.forEach(function(e){var t,i,o,n,a,r;e.ScriptID===c&&(t=parseFloat(d.style.width,10)+s+"px",i=parseFloat(d.style.height,10)+l+"px",o=0,n=s/20,a=l/20,r=null,r=setInterval(function(){if(20<=o){d.style.width=t,d.style.height=i;var e=v.GetToolByScriptOrExperience(c,u);return e.Width=d.style.width,e.Height=d.style.height,v.Write(),void clearInterval(r)}0!=n&&(d.style.width=d.offsetWidth+n+"px"),0!=a&&(d.style.height=d.offsetHeight+a+"px"),o++},25))}):A.Log("Comms.CB_ResizeWindowWithAnimation() iFraC4AW iframe not found for script id:"+c)},this.CB_ReceivePostMessage=function(e){A.Log("Comms.CB_ReceivePostMessage() => event.data: "+e.data);var t=e.origin||e.originalEvent.origin;if(t==C4A.Comms.DomainTI){if(3<=e.data.length&&"!_{"!=e.data.substring(0,3))if(A.Log("Comms.CB_ReceivePostMessage() => About to evaluate"),-1!=e.data.indexOf("window.location.href")){var i=e.data.replace("window.location.href=","").replace(/("|')/g,"");A.Log("Comms.CB_ReceivePostMessage() => window.location.href = "+i),window.location.href=i}else{var e=e.data.replace("C4A.Comms.","").replace(/, /g,",").replace(");","").split("("),o=e[0],n=e[1].split(",");switch(o){case"CB_ChatClear":C4A.Comms.CB_ChatClear(n[0].replace(/'/g,""));break;case"CB_ChatCreated":C4A.Comms.CB_ChatCreated(n[0].replace(/'/g,""),n[1].replace(/'/g,""),n[2].replace(/'/g,""),n[3].replace(/'/g,""),n[4].replace(/'/g,""),n[5].replace(/'/g,""));break;case"CB_CloseProactive":C4A.Comms.CB_CloseProactive();break;case"CB_CloseWidget":C4A.Comms.CB_CloseWidget(Number(n[0]));break;case"CB_MinimiseWidget":C4A.Comms.CB_MinimiseWidget(Number(n[0]));break;case"CB_ResetTools":C4A.Comms.CB_ResetTools();break;case"CB_ResizeWindow":C4A.Comms.CB_ResizeWindow(Number(n[0]),Number(n[1]),Number(n[2]),n[3].replace(/'/g,""));break;case"CB_ResizeWindowWithAnimation":C4A.Comms.CB_ResizeWindowWithAnimation(Number(n[0]),Number(n[1]),Number(n[2]),n[3].replace(/'/g,""));break;case"CB_StopProactiveTimer":C4A.Comms.CB_StopProactiveTimer();break;default:A.Log('Comms.CB_ReceivePostMessage() => Invalid function: "'+o+'"')}}}else A.Log("Comms.CB_ReceivePostMessage() => [ERROR] Invalid Origin: ("+t+") - C4A.Comms.DomainTI: ("+C4A.Comms.DomainTI+")")},this.CB_ProactiveSessionCreated=function(e){"function"==typeof r&&r(e),r=null},this.CB_IssueProactive=function(e,t){var i;A.Log("Comms.CB_IssueProactive() => toolIdx: "+e+", ruleIdx: "+t),!1!==m.IsDeviceCompatibleForTools()&&(null!==(i=v.Data.ProTools)&&S.Issue(i[e],i[e].Rules[t]),v.Write())},this.CB_DontIssueProactive=function(e,t){A.Log("Comms.CB_DontIssueProactive() => toolIdx: "+e+", ruleIdx: "+t);var i=v.Data.ProTools;null!==i&&(i[e].Rules[t].S="VOID"),v.Write()},this.CB_CloseProactive=function(){A.Log("Comms.CB_CloseProactive()"),S.CloseProactive();var e=v.Data.ProTools;e.forEach(function(e,t){e.Dis=!1});var i=999;e.forEach(function(e,t){0==e.Rules[0].RT&&(i=t)}),999!==i&&(e.splice(i,1),A.Log("Comms.CB_CloseProactive() => Manual proactive removed from array")),v.Write()},this.CB_ChatCreated=function(t,i,o,n,a,e){A.Log("Comms.CB_ChatCreated() => experienceGuid: "+t+" - instanceGuid: "+i+" - chatGuid: "+o+" - chatAccountGuid: "+n+" - chatExperienceGuid: "+a+" - chatStartDTS: "+e),this.CB_AddActivity("","",e,"CH",o,"");var r=v.Data.IsActiveProactive=!1;v.Data.Tools?v.Data.Tools.forEach(function(e){e.ExpGuid.toUpperCase()==t.toUpperCase()&&(r=!0,e.ChatGuid=o.toUpperCase(),e.ChatAccountGuid=n.toUpperCase(),e.ChatExperienceGuid=a.toUpperCase())}):A.Log("Comms.CB_ChatCreated() => There are no Tools"),v.Data.ProTools?v.Data.ProTools.forEach(function(e){e.EGuid.toUpperCase()===t.toUpperCase()&&(r=!0,e.ChatGuid=o.toUpperCase(),e.ChatAccountGuid=n.toUpperCase(),e.ChatExperienceGuid=a.toUpperCase(),e.InstanceGuid=i.toUpperCase(),e.Dis=!0)}):A.Log("Comms.CB_ChatCreated() => There are no ProTools"),!1===r?A.Log("Comms.CB_ChatCreated() => [Error]: Unable to find Tool/Proactive"):A.Log("Comms.CB_ChatCreated() => Tool/Proactive found and updated with chatGuid"),v.Write()},this.CB_ChatClear=function(i){A.Log("Comms.CB_ChatClear() => experienceGuid: "+i);var o=-1,n=!1;v.Data.Tools&&(v.Data.Tools.forEach(function(e,t){e.ExpGuid.toUpperCase()==i.toUpperCase()&&(n=!0,e.ChatAccountGuid=null,e.ChatExperienceGuid=null,e.ChatGuid=null,e.Displayed=!1,9999==e.ScriptID&&(o=t))}),-1!=o&&v.Data.Tools.splice(o,1)),o=-1,l&&(l.forEach(function(e,t){9999==e.ScriptID&&(o=t)}),-1!=o&&l.splice(o,1)),v.Data.ProTools&&(v.Data.ProTools.forEach(function(e,t){e.EGuid.toUpperCase()==i.toUpperCase()&&0==e.Rules[0].RT&&(o=t,n=!0)}),-1!==o&&v.Data.ProTools.splice(o,1)),A.Log("Comms.CB_ChatClear() =>  found: "+n),v.Write()},this.CB_ResetTools=function(){A.Log("Comms.CB_ResetTools()"),l&&l.forEach(function(e){e.Widget.Close(!1)}),v.Data.Tools&&v.Data.Tools.forEach(function(e){e.Displayed=!1,e.ChatGuid=null,e.ChatAccountGuid=null}),v.Data.ProTools&&v.Data.ProTools.forEach(function(e){e.Dis=!1,e.ChatGuid&&(e.ChatGuid=null),e.ChatAccountGuid&&(e.ChatAccountGuid=null),e.ChatExperienceGuid&&(e.ChatExperienceGuid=null),e.InstanceGuid&&(e.InstanceGuid=null)}),S.CloseProactive(),v.Write()},this.CB_OpenWidget=function(t){A.Log("Comms.CB_OpenWidget() => scriptId: "+t),l&&0!=t&&l.forEach(function(e){e.ScriptID==t&&e.Widget.Open(void 0,!0)})},this.CB_CloseWidget=function(e){A.Log("Comms.CB_CloseWidget() => scriptId: "+e),l&&0!=e&&l.forEach(function(e){e.Widget.Close(!1)}),v.Write()},this.CB_MinimiseWidget=function(t){A.Log("Comms.CB_MinimiseWidget() => scriptId: "+t),l&&0!=t&&l.forEach(function(e){e.ScriptID==t&&e.Widget.Close(!0)}),v.Write()},this.CB_HotspotHit=function(e){A.Log("Comms.CB_HotspotHit() => hotspotGuid: "+e),v.Data.HSGUID=e.toUpperCase(),v.Write()},this.CB_AddProactiveTool=function(e){v.Data.ProTools.push(e),S.Initilize()},this.CB_DisplayManualProactive=function(e,t,i,o,n,a,r,s,l,c,u){var d=[],u={RT:0,RM:"",RDS:1,RS:u};d.push(u);i={PGUID:e,EGuid:t,Dis:!1,TT:o,IT:4,H:a,W:r,GO:s,AId:l,ET:0,EM:0,EDWMin:c,SPGUID:i,Rules:d};v.Data.ProTools.push(i);d=v.Data.ProTools.length-1;1==i.TT||2==i.TT||4==i.TT?(d="ExpGuid="+i.EGuid+"&ToolIdx="+d+"&RuleIdx=0",A.Log("Proactive.CheckRules() => IsExperienceAvailable - Sending data: "+d),T.SendToServer("/IsExperienceAvailable",d)):S.Issue(i,i.Rules[0])},this.CB_StopProactiveTimer=function(){S.StopProactiveTimer()}},S=new function(){var r,n=[],a=[],t=null,s=0,f=0,l=null,c=null,u=null,d=null;function I(){A.Log("Proactive.StopTimerAndVoidAllRules() - Stopping Timer, and setting all Proactive Rules to VOID"),C4A.Proactive.StopProactiveTimer();var e=v.Data.ProTools;if(null!=e)for(var t in e)for(var i in e[t].Rules)e[t].Rules[i].S="VOID"}this.AddUrlData=function(e){c=e},this.AddCustomData=function(e){u=e},this.AddCustomDataGuid=function(e){d=e},this.AddPage=function(e,t){var i=isNaN(e)||null==e,o=t.length<4||null==t;i||o||(n.push(e),a.push(t))},this.CloseProactive=function(){l&&(l.Close(),l=null)},this.Initilize=function(){var i,o,e;A.Log("Proactive.Initilize()"),p.AllowProactives?m.IsDeviceCompatibleForTools()?v.Data.IsActiveProactive?"T"==v.Data.Access.substr(3,1)?null==(e=v.Data.ProTools)||null!=e&&0==e.length?A.Log("Proactive.Initilize() No Proactives - No need to check rules"):(i=0,o=m.UIGetWindowHeightWidth().Width,e.forEach(function(e){if(0!=e.EDWMin&&e.EDWMin>=o||0!=e.EDWMax&&e.EDWMax<=o){for(var t in e.Rules)e.Rules[t].S="VOID";++i}}),e=e.length,i!=e?(A.Log("Proactive.Initilize() There are "+e+" proactives that need to be checked..."),null!=t&&(clearInterval(t),t=null),f=Math.floor((new Date).getTime()/1e3),t=setInterval(function(){0==S.CheckRules()&&(clearInterval(t),t=null)},5e3),A.Log("Proactive.Initilize() Timer started, every 5 seconds...")):A.Log("Proactive.Initilize() All rules exceptions are below the screen width of:"+o+" - No need to check rules")):A.Log("Proactive.Initilize() Proactives not allowed - No need to check rules"):A.Log("Proactive.Initilize() Proactives are not active, possibly a previous chat has occurred - No need to check rules"):A.Log("Proactive.Initilize() IsDeviceCompatibleForTools returned false - No need to check rules"):A.Log("Proactive.Initilize() Track.AllowProactives returned false - No need to check rules")},this.CheckRules=function(){A.Log("Proactive.CheckRules()");var e,t=Math.floor((new Date).getTime()/1e3),i=window.location.host.toUpperCase().replace("WWW.",""),o=window.location.href.toUpperCase(),n=null;null!=v.Data.HSGUID&&(n=v.Data.HSGUID.toString().toUpperCase());if(A.Log("Proactive.CheckRules() _proTimerStarted: "+f+" - lNow:"+t),f+600<t)return A.Log("Proactive.CheckRules() ProactiveTimer Limit (600) secs exceeded, stopping the timer"),!1;var a=v.Data.ProTools;if(null==a)return A.Log("Proactive.CheckRules() ProTools is NULL - returning"),!1;if(0==v.Data.IsActiveProactive)return A.Log("Proactive.CheckRules() Proactives are not active, a previous chat has occurred - StopTimerAndVoidAllRules()"),I(),!1;A.StartGroup("Proactive.CheckRules() Looping REACTIVE Tools");var r=v.Data.Tools;for(l in r){var s=r[l];A.Log("Proactive.CheckRules() Checking Reactive Tool "+(parseInt(l)+1)+" of "+r.length),null!=s.ChatGuid&&(A.Log("Proactive.CheckRules() Visitor has or is in a chat - StopTimerAndVoidAllRules()"),I()),s.Displayed&&(A.Log("Proactive.CheckRules() Visitor has a tool displayed - StopTimerAndVoidAllRules()"),I())}A.EndGroup();var l,c=0;for(l in a)for(u in(s=a[l]).Rules)"PROCESS"==(d=s.Rules[u]).S&&c++;if(0==c)return A.Log("Proactive.CheckRules() There are no rules that need to be processed"),!1;for(l in A.StartGroup("Proactive.CheckRules() Looping PROACTIVE Tools"),A.Log("Proactive.CheckRules() Globals:\n\tNOW: "+t+"\n\tSession.Data.SiteHitUTC: "+v.Data.SiteHitUTC+"\n\tSession.Data.PageHitUTC: "+v.Data.PageHitUTC+"\n\twindow.location.host: "+i+"\n\tSession.Data.HSGUID: "+n),a){var u,s=a[l];for(u in A.StartGroup("Proactive.CheckRules() Looping Rules for Tool "+(parseInt(l)+1)+" of "+a.length+" (ToolType: "+s.TT+", NextCheckUTC: "+s.NextCheckUTC+")"),s.Rules){var d=s.Rules[u];if(A.StartGroup("Proactive.CheckRules() Checking Rule "+(parseInt(u)+1)+" of "+s.Rules.length),"VOID"!=d.S&&"ISSUED"!=d.S)if(e=d.RM.toUpperCase(),A.Log("Proactive.CheckRules() Rule data:\n\tRT  (Rule Type)      : "+d.RT+"\n\tRM  (Rule Match)     : "+e+"\n\tRDS (Rule Delay Secs): "+d.RDS),t<=s.NextCheckUTC)A.Log("Proactive.CheckRules() NextCheckUTC is AFTER NOW, no need to check this rule"),A.EndGroup();else{var h=1==d.RT&&e==i,p=2==d.RT&&e==o,C=3==d.RT&&-1<o.indexOf(e),g=4==d.RT&&e==n,m=g?"HOTSPOT":C?"CONTAINS":p?"EXACT":h?"DOMAIN":"",D=v.Data.SiteHitUTC+d.RDS;if((h||p||C||g)&&D<t){if(1!=s.TT&&2!=s.TT&&4!=s.TT)return A.Log('Proactive.CheckRules() MATCHED  - "'+m+'" - Not a Chat/Video/Click2Call proactive - call Proactive.Issue()'),S.Issue(s,d),A.EndGroup(),!0;g="ExpGuid="+s.EGuid+"&ToolIdx="+l+"&RuleIdx="+u;return A.Log('Proactive.CheckRules() MATCHED  - "'+m+'" - Its a Chat/Video/Click2Call proactive - call end-point IsExperienceAvailable - With data:'+g),T.SendToServer("/IsExperienceAvailable",g),A.EndGroup(),!0}A.Log('Proactive.CheckRules() NO MATCH - "'+m+'" - NOW: '+t+" - ISSUEON: "+D+" - DIFF: "+(D-t)),A.EndGroup()}else A.Log('Proactive.CheckRules() Rule marked as "'+d.S+'"'),A.EndGroup()}A.EndGroup()}A.EndGroup(),A.EndGroup()},this.BuildiFrame=function(e,t){var i=document.getElementById("iFraC4AWPro");i||((i=document.createElement("iframe")).id="iFraC4AWPro",i.title="Click4Assistance Live Chat",i.style.display="none",i.allow="camera; microphone",i.setAttribute("AlignRight","true"),i.style.marginheight="0px",i.style.marginWidth="0px",i.style.borderWidth="0px",i.allowtransparency=!0,document.body.insertBefore(i,null),A.Log("Proactive.BuildiFrame()iFrame Created - proTool.W:"+e.W+" - proTool.H:"+e.H));i.style.cssText="border:0; z-index:2147483601; width:"+e.W+"px; height:"+e.H+"px;",i.style.height=e.H+"px",i.style.width=e.W+"px",i.style.display="none";var o="",o=T.DomainTI+"/"+T.GetPageName(e.TT)+"?AccGUID="+h+"&ExpGUID="+e.EGuid+"&ToolType="+e.TT+"&ChatGUID="+e.ChatGuid+"&ChatAccountGUID="+e.ChatAccountGuid+"&ImpType="+e.IT+"&ProactiveGUID="+e.PGUID+"&SessionProGUID="+e.SPGUID+"&SID="+v.Data.SID+"&RSound="+t;null!=c&&(o+="&"+c),null!=u&&(o+="&PushD="+u),null!=d&&(o+="&CustomDataGuid="+d);try{var n=null==h?null:h.toUpperCase();null==h||"01DCDED4-D168-4D22-AB4B-D073501B8353"!=n&&"05E4E0A8-61D3-41CC-8454-3B2425F643C8"!=n&&"3A7ADAFD-9926-4503-BB98-E3BB2B04DC7B"!=n&&"19DF1B3D-4155-41DA-A3C4-017C88422BCF"!=n&&"BCDB368E-7FDB-4C67-BA90-27BF237F1002"!=n&&"E02CCD62-1AAB-41AA-B50F-E61C4BE12EA6"!=n||(n=document.location.href,m.IsUrlXSS(n)?o+="&OpenedFromFullPageUrl=XSS":o+="&OpenedFromFullPageUrl="+encodeURIComponent(n))}catch(e){A.Log("Proactive.BuildiFrame() - OpenedFromFullPageUrl _iFra:"+i.id+" - url:"+o)}return i.src=o,A.Log("Proactive.BuildiFrame()iFrame src:"+i.src),i},this.StopProactiveTimer=function(){null!=t&&(clearInterval(t),t=null),A.Log("Proactive.StopProactiveTimer() Stopped")},this.Issue=function(t,i){if(A.StartGroup("Proactive.Issue()"),s++,A.Log("Proactive.Issue() _proIssueCount: "+s),t.Issued=1,t.Dis=!0,t.NextCheckUTC=Math.floor((new Date).getTime()/1e3)+60*t.EM,i.S="ISSUED",1==t.ESAR&&(A.Log("Proactive.Issue() Proactive has been issued and we need to stop all other proactives being issued - VOID all rules and stop timer"),I()),v.Write(),t.Dis=!1,v.Write(),2==t.IT||4==t.IT||5==t.IT){if(3<=s)return A.Log("Proactive.Issue.DisplayIssuedProactive() ERROR - _proIssueCount >= 3, abort showing proactive & stop proactive timer"),void C4A.Proactive.StopProactiveTimer();var e,o,n,a=0==t.Rules[0].RT;t.SPGUID,e=t.EGuid,o=t.TT,n=a,a=function(e){if(3<=s)return A.Log("Proactive.Issue.DisplayIssuedProactive() ERROR - _proIssueCount >= 3, abort showing proactive & stop proactive timer"),void C4A.Proactive.StopProactiveTimer();t.SPGUID=e,v.Write(),(r=S.BuildiFrame(t,i.RS)).onload=function(){null==l&&(l=new C4A.Animation),l.Initilize(r,t.H,t.W,0,t.GO),l.Animate(t.AId),r.onload=null}},n="SessionGUID="+v.Data.SID+"&ExperienceGUID="+e+"&ToolType="+o+"&IsManualPush="+n,A.Log("Proactive.SetIssuedOn()Sending data:"+n),!void T.CreateProactiveSession(a,n),A.EndGroup()}else A.Log("Proactive.Issue() ERROR - Invalid Implementation Type for Proactive (can only be a 2,4,5)")}},A=new function(){function l(e){var t,i;null!=e&&(i=t="",1<=(e=e.split("()")).length&&(t=e[0]),2<=e.length&&(i=e[1]),"Comms.SendToServer"==t&&0<i.indexOf("HeartBeat")||(e=document.getElementById("debugDiv"))&&(e.innerHTML+="<div style='color: grey;'>"+t+"</div><div style='margin-left: 20px;'>"+i+"</div>"))}this.Data=[],this.DisplayPanel=function(){var e=document.createElement("div");e.setAttribute("style",'background-color: #f5f5f5; border: 1px solid #ccc; box-sizing: border-box; font-family: "Consolas"; width: 100%;');var t=document.createElement("div");t.setAttribute("style","background-color: #ccc; box-sizing: border-box; color: #000; font-size: 16px; font-weight: 700; padding: 8px;"),t.innerHTML="Debugging";var i=document.createElement("button");i.innerHTML="Session",i.onclick=function(){var e=document.getElementById("lblSession");e&&(e.innerText=C4A.SessionData())};var o=document.createElement("div");o.id="lblSession";var n=document.createElement("button");n.innerHTML="Persist",n.onclick=function(){var e=document.getElementById("lblPersist");e&&(e.innerText=C4A.PersistData())};var a=document.createElement("div");a.id="lblPersist";var r=document.createElement("div");r.id="debugDiv",r.setAttribute("style","border-top: 1px solid #ccc; box-sizing: border-box; font-size: 14px; overflow-wrap: anywhere; padding: 16px;"),e.appendChild(t),e.appendChild(i),e.appendChild(o),e.appendChild(n),e.appendChild(a),e.appendChild(r),document.body.appendChild(e);for(var s=0;s<this.Data.length;s++)l(this.Data[s])},this.Log=function(e){null!=e&&(500<this.Data.length&&(this.Data=[]),this.Data.push(e),document.getElementById("debugDiv")&&l(e))},this.StartGroup=function(e){0},this.EndGroup=function(){0}};return{Run:function(e){!function(e){try{if(A.Log("Run()"),"9dc8a701-9196-481f-9797-b573fb1b165f"==e.toLowerCase()||"8958cd1d-e888-4739-96ee-870e099c9e28"==e.toLowerCase()||"30fef422-b802-4eb1-ad51-694c6d6bed22"==e.toLowerCase()||"bec36ef0-53b0-45e5-8e6a-6f9765a1abc6"==e.toLowerCase()||"09c15c40-a8e9-4be3-821d-88ad40a37174"==e.toLowerCase())return alert("Your C4A account has been removed, please remove all C4A scripts from your website.");if(null!=document.referrer&&-1<document.referrer.toUpperCase().indexOf(T.DomainTI.toUpperCase())&&(A.Log("Run() - Referred by the ToolInterface - Clearing Session"),window.sessionStorage.clear()),A.Log("Run() - sessionStorage:"+(window.sessionStorage?"True":"False")),-1<location.href.toUpperCase().indexOf("C4ADONTTRACK=Y"))return;var t=null==(h=e)?null:h.toUpperCase();if(null==h||"01DCDED4-D168-4D22-AB4B-D073501B8353"!=t&&"05E4E0A8-61D3-41CC-8454-3B2425F643C8"!=t&&"3A7ADAFD-9926-4503-BB98-E3BB2B04DC7B"!=t&&"19DF1B3D-4155-41DA-A3C4-017C88422BCF"!=t&&"BCDB368E-7FDB-4C67-BA90-27BF237F1002"!=t&&"E02CCD62-1AAB-41AA-B50F-E61C4BE12EA6"!=t||(t=document.location.href,m.IsUrlXSS(t)||(v.Data.PageEntryURL=encodeURIComponent(t))),v.Read(),null!=v.Data.AccountGuid&&v.Data.AccountGuid.toUpperCase()!=e.toUpperCase()&&(A.Log("Run() - AccountGuid is different to the one in the Session object - ResetData()"),v.ResetData()),!v.Data.Active)return A.Log("Run - Account not enabled"),m.UIShowWarning("Your Account is not enabled");""==v.Data.SCook&&(v.Data.SCook=!!v.TestCookie()),""==v.Data.PCook&&(v.Data.PCook=!!s.TestCookie()),window.addEventListener?addEventListener("message",C4A.Comms.CB_ReceivePostMessage,!1):attachEvent("onmessage",C4A.Comms.CB_ReceivePostMessage);for(var i,o=!1,n=0;n<l.length;n++){for(var a in v.Data.Tools)v.Data.Tools[a].ScriptID==l[n].ScriptID&&(o=!0);o||(i={ScriptID:l[n].ScriptID,ToolType:0,ImpType:0,Height:0,Width:0,Displayed:!1,ChatGuid:null,ChatAccountGuid:null,ExpGuid:null},v.Data.Tools.push(i),v.Data.ReqTool=!0,v.Write())}if(l.length!=v.Data.Tools.length&&A.Log("Run()ERROR - Tools array does not match Tools collection"),A.Log("Run()Tools loaded"),null==v.Data.SID&&1==v.Data.PCook&&s.Read(),A.Log("Run()Persist.PID:"+s.Data.PID),!p.Enabled)return A.Log("Run - Tracking not enabled (set by script)"),T.CB_Initilize();if(!v.Data.IsActiveTracking)return A.Log("Run - Tracking not enabled (set by server)"),T.CB_Initilize();T.SendToServer("/PageHit/",v.URL()),A.Log("Run()Page Hit Registered")}catch(e){A.Log("EXCEPTION()<b style='color:red;'>EXCEPTION<b>:<br>"+e.stack)}}(e)},Track:p,Tools:function(e,t){t=new i(this.ScriptID=e,t);return l.push(t),t;function i(e,t){var i=null,o=null,n=null,a=[];this.ScriptID=e,this.MyElementID=t,this.OpenNewTabOnWidth=320,this.Button=new r(this),this.Widget=new s(this),this.ExcludeUrl=function(e){a.push(e)},this.IsExcludeUrl=function(){var e,t=document.location.href.toLowerCase();for(e in a)if(-1!=t.indexOf(a[e]))return A.Log("Tools.Tool.IsExcludeUrl()Page is an excluded url"),!0;return!1},this.AddUrlData=function(e){o=e},this.GetUrlData=function(){return o},this.AddCustomData=function(e){e=(i=e).toLowerCase().indexOf("&");-1!=e&&(i=i.replace(/&/g,"%26")),-1!=(e=i.indexOf("?"))&&(i=i.replace(/\?/g,"%3F"))},this.GetCustomData=function(){return i},this.AddCustomDataGuid=function(e){n=e},this.GetCustomDataGuid=function(){return n}}function r(e){var s=e;this.MobileScreenWidth=480,this.FixedUrl=null,this.btnC4A=document.getElementById("C4A_btn"+s.ScriptID),this.btnZIndex=2147483598,this.DesktopCss="position:fixed; bottom:0; right:0; z-index:"+this.btnZIndex,this.MobileCss="position:fixed; bottom:8px; right:8px; z-index:"+this.btnZIndex,this.WrapInLink=!0,this.BtnAltTag="Live Chat Software Click4Assistance";var l=document.location.href,l=m.IsUrlXSS(l)?"":(l=l.split("?")[0],encodeURIComponent(l));this.Render=function(){0==m.IsDeviceCompatibleForTools()||9999==s.ScriptID||s.IsExcludeUrl()||(A.Log("Button.Render()"),A.Log("Button.Render()Browser width:"+m.UIGetWindowHeightWidth().Width),A.Log("Button.Render()OpenNewTabOnWidth:"+s.OpenNewTabOnWidth),null!=s.MyElementID&&void 0!==s.MyElementID&&this.RenderForExistingElement(),this.btnC4A||null!=s.MyElementID&&void 0!==s.MyElementID||this.RenderNewC4AButton())},this.RenderForExistingElement=function(){A.Log("Button.Render()Attempt to configure existing button");var e,t,i,o,n=this.MobileScreenWidth>=m.UIGetWindowHeightWidth().Width,a=v.GetToolByScriptOrExperience(s.ScriptID,s.ExpGuid),r=document.getElementById(s.MyElementID);r&&(r.style.zIndex=this.btnZIndex,r.onmouseover=function(){this.style.cursor="pointer"},r.onmouseout=function(){this.style.cursor="default"},r.onkeypress=function(e){13==e.keyCode&&this.click()},1==a.ImpType||s.OpenNewTabOnWidth>=m.UIGetWindowHeightWidth().Width||m.IsDeviceiPhone()?(e=0!=a.ToolType?a.ToolType:1,o=T.DomainTI+"/"+T.GetPageName(e)+"?AccGUID="+h+"&ScriptID="+s.ScriptID+"&ExpGUID="+a.ExpGuid+"&ToolType="+e+"&SID="+v.Data.SID,t=s.GetUrlData(),i=s.GetCustomDataGuid(),null!=t&&(o+="&"+t),o+="&PushD="+s.GetCustomData(),null!=i&&(o+="&CustomDataGuid="+i),r.setAttribute("c4a_Url",o),r.setAttribute("c4a_Name",e),r.onclick=function(){var e=this.getAttribute("c4a_Url"),t=this.getAttribute("c4a_Name"),i="";isNaN(a.Height)||(i+="height="+a.Height+","),isNaN(a.Width)||(i+="width="+a.Width);i="menubar=no,location=no,resizable=no,scrollbars=auto,status=no,"+i;return window.open(e,t,i),!1}):r.onclick=function(){s.Widget.Open()},o=null!=this.FixedUrl?this.FixedUrl:T.DomainSI+"/Button?strAccGUID="+h+"&strScriptID="+s.ScriptID+"&strIsMobile="+n+"&strPageUrl="+l,"IMG"==r.nodeName?r.src=o:(r.style.backgroundSize="contain",r.style.backgroundImage="url('"+o+"')"))},this.RenderNewC4AButton=function(){A.Log("Button.Render()Attempt to create our own button");var e=this.MobileScreenWidth>=m.UIGetWindowHeightWidth().Width,r=v.GetToolByScriptOrExperience(s.ScriptID,s.ExpGuid),t=null;this.btnC4A=document.createElement("img"),this.btnC4A.id="C4A_btn"+s.ScriptID,this.btnC4A.setAttribute("alt",this.BtnAltTag),this.btnC4A.onkeypress=function(e){13==e.keyCode&&this.click()},1==this.WrapInLink?((t=document.createElement("a")).setAttribute("id","C4A_lnk"+s.ScriptID),t.setAttribute("title",this.BtnAltTag),t.setAttribute("tabindex","0"),t.setAttribute("role","button"),t.onclick=function(e){document.getElementById("C4A_btn"+s.ScriptID).click()},t.onkeypress=function(e){13==e.keyCode&&document.getElementById("C4A_btn"+s.ScriptID).click()},t.onmouseover=function(){this.style.cursor="pointer"},t.onmouseout=function(){this.style.cursor="default"},t.style.zIndex=this.btnZIndex,t.style.cssText=(1==e?this.MobileCss:this.DesktopCss)+";line-height:0;"):(this.btnC4A.setAttribute("role","button"),this.btnC4A.setAttribute("tabindex","0"),this.btnC4A.setAttribute("title",this.BtnAltTag),this.btnC4A.onmouseover=function(){this.style.cursor="pointer"},this.btnC4A.onmouseout=function(){this.style.cursor="default"},this.btnC4A.style.zIndex=this.btnZIndex,this.btnC4A.style.cssText=1==e?this.MobileCss:this.DesktopCss),1==r.ImpType||s.OpenNewTabOnWidth>=m.UIGetWindowHeightWidth().Width||m.IsDeviceiPhone()?this.btnC4A.onclick=function(e){var t=0!=r.ToolType?r.ToolType:1,i=T.DomainTI+"/"+T.GetPageName(t)+"?AccGUID="+h+"&ScriptID="+s.ScriptID+"&ExpGUID="+r.ExpGuid+"&ToolType="+t+"&SID="+v.Data.SID,o=s.GetUrlData(),n=s.GetCustomDataGuid();null!=o&&(i+="&"+o),i+="&PushD="+s.GetCustomData(),null!=n&&(i+="&CustomDataGuid="+n);try{var a=h.toUpperCase();null==h||"01DCDED4-D168-4D22-AB4B-D073501B8353"!=a&&"05E4E0A8-61D3-41CC-8454-3B2425F643C8"!=a&&"3A7ADAFD-9926-4503-BB98-E3BB2B04DC7B"!=a&&"19DF1B3D-4155-41DA-A3C4-017C88422BCF"!=a&&"BCDB368E-7FDB-4C67-BA90-27BF237F1002"!=a&&"E02CCD62-1AAB-41AA-B50F-E61C4BE12EA6"!=a||(a=document.location.href,m.IsUrlXSS(a)?i+="&OpenedFromFullPageUrl=XSS":i+="&OpenedFromFullPageUrl="+encodeURIComponent(a))}catch(e){A.Log("Button.Render() - OpenedFromFullPageUrl _iFra:"+_iFra.id+" - url:"+i)}/^((?!chrome|android|crios|fxios).)*safari/i.test(navigator.userAgent)?window.open(i,t,"menubar=no,location=no,resizable=no,scrollbars=auto,status=no"):(n="menubar=no,location=no,resizable=no,scrollbars=auto,status=no,height="+r.Height+",width="+r.Width,window.open(i,t,n)),e.stopPropagation(),e.preventDefault()}:this.btnC4A.onclick=function(e){var t,i,o;C4A.iOSFix&&(t=-1!=navigator.userAgent.indexOf("iPhone"),i=-1!=navigator.userAgent.indexOf("iPod"),o=-1!=navigator.userAgent.indexOf("iPad"),(t||i||o)&&(A.Log("SI - iOS device detected"),0<document.querySelectorAll('meta[name="viewport"]').length||(A.Log("SI - Meta viewport added for iOS device"),(o=document.createElement("meta")).id="viewport",o.name="viewport",o.content="initial-scale = 1.0,maximum-scale = 1.0",document.getElementsByTagName("head")[0].appendChild(o)))),s.Widget.Open(),e.stopPropagation(),e.preventDefault()};var i=null!=this.FixedUrl?this.FixedUrl:T.DomainSI+"/Button?strAccGUID="+h+"&strScriptID="+s.ScriptID+"&strIsMobile="+e+"&strPageUrl="+l;this.btnC4A.src=i,1==this.WrapInLink?(t.insertBefore(this.btnC4A,null),document.body.insertBefore(t,null)):document.body.insertBefore(this.btnC4A,null),A.Log("Button.Render()Added to body: "+this.btnC4A.id+"... CSS: "+this.btnC4A.style.cssText+", isMobile:"+e+" , src:+"+this.btnC4A.src)}}function s(t){var a=t,r=350,s=350,l=document.getElementById("iFraC4AW"+a.ScriptID);this.Css="position:fixed; right:0; bottom:0; z-index:2147483599; border:0; ",this.AlignRight=!0,this._animat=null,this.Animation=function(){return null==this._animat&&(this._animat=new C4A.Animation),this._animat},this.Render=function(){var e;A.Log("Widget.Render()"),A.Log("Widget.Render()Css:"+this.Css),l||(e=v.GetToolByScriptOrExperience(t.ScriptID,t.ExpGuid),r=e.Width,s=e.Height,(l=document.createElement("iframe")).id="iFraC4AW"+a.ScriptID,l.title="Click4Assistance Live Chat",l.style.cssText=this.Css+";width:"+r+"px; height:"+s+"px;",l.style.display="none",l.allow="camera; microphone",l.style.marginheight="0px",l.style.marginWidth="0px",l.style.borderWidth="0px",l.allowtransparency=!0,l.setAttribute("AlignRight",this.AlignRight),document.body.insertBefore(l,null))},this.Open=function(e,t){if(A.Log("Widget.Open()"),!a.IsExcludeUrl()){null!=a.Button.btnC4A&&(a.Button.btnC4A.style.display="none"),void 0===t&&(t=!1),A.Log("Widget.Open() - IsCallback:"+t),A.Log("Widget.Open() - ScriptID:"+a.ScriptID+" - ExpGuid:"+a.ExpGuid);var i=v.GetToolByScriptOrExperience(a.ScriptID,a.ExpGuid);if(0==t&&(null==i.ExpGuid||0==i.ExpGuid.length))return v.Write(),void T.SendToServer("/ToolData/",v.URL()+"&ScriptID="+i.ScriptID);i.Displayed=!0,v.Write();var o,n=T.DomainTI+"/"+T.GetPageName(i.ToolType)+"?AccGUID="+h+"&ScriptID="+i.ScriptID+"&ExpGUID="+i.ExpGuid+"&ToolType="+i.ToolType+"&ChatGUID="+i.ChatGuid+"&ChatAccountGUID="+i.ChatAccountGuid+"&SID="+v.Data.SID;void 0!==e&&(n+="&ThisFormType="+e),null!=a.GetUrlData()&&(n+="&"+a.GetUrlData()),n+="&PushD="+a.GetCustomData(),null!=a.GetCustomDataGuid()&&(n+="&CustomDataGuid="+a.GetCustomDataGuid());try{null==h||"01DCDED4-D168-4D22-AB4B-D073501B8353"!=h.toUpperCase()&&"05E4E0A8-61D3-41CC-8454-3B2425F643C8"!=h.toUpperCase()&&"3A7ADAFD-9926-4503-BB98-E3BB2B04DC7B"!=h.toUpperCase()&&"19DF1B3D-4155-41DA-A3C4-017C88422BCF"!=h.toUpperCase()&&"BCDB368E-7FDB-4C67-BA90-27BF237F1002"!=h.toUpperCase()&&"E02CCD62-1AAB-41AA-B50F-E61C4BE12EA6"!=h.toUpperCase()||(o=document.location.href,m.IsUrlXSS(o)?n+="&OpenedFromFullPageUrl=XSS":n+="&OpenedFromFullPageUrl="+encodeURIComponent(o))}catch(e){A.Log("Widget.Open() - OpenedFromFullPageUrl _iFra:"+l.id+" - src:"+n)}A.Log("Widget.Open()_iFra:"+l.id+" - src:"+n),l.setAttribute("RealSrc",n),l.src=l.getAttribute("RealSrc")+"&Rnd="+Math.random();t=this.Animation(),e="";null!=a.Button.btnC4A&&(e=(document.getElementById("C4A_lnk"+i.ScriptID)||a.Button.btnC4A).style.top),t.Initilize(l,s,r,e,!1),t.ScriptId=i.ScriptID,1==i.ToolType||2==i.ToolType?i.ChatGuid?(A.Log("Widget.Open() - Animate(4)"),t.Animate(4)):T.SendToServer("/AnimatePreDialogWindow/","ExpGuid="+i.ExpGuid+"&ScriptID="+i.ScriptID+"&Top="+e):(A.Log("Widget.Open() - Animate(5)"),t.Animate(5)),c.push(t)}},this.Close=function(e){A.Log("Widget.Close()"),null!=a.Button.btnC4A&&(a.Button.btnC4A.style.display="block"),A.Log("Widget.Close() No of Animations Before :"+c.length);for(var t=999,i=0;i<c.length;i++){A.Log("Widget.Close() Looping - Idx:"+i);var o=c[i];o.ScriptId==a.ScriptID&&(t=i,A.Log("Widget.Close() animat.ScriptId:"+o.ScriptId),o.Close(a.ScriptID,e))}999!=t&&c.splice(t,1),A.Log("Widget.Close() No of Animations After:"+c.length),v.GetToolByScriptOrExperience(a.ScriptID,a.ExpGuid).Displayed=!1,v.Write()}}},Conversion:u,Prospect:d,Comms:T,Proactive:S,ClearSessionData:function(){v.Data={}},PersistData:function(){return JSON.stringify(s.Data)},SessionData:function(){return JSON.stringify(v.Data)},Animation:function(){var l=null,c=0,u=0,d=0,h=!1,p=!1,C=null;function r(){l.style.top=0,l.style.left=0,l.style.position="absolute",l.style.height=c,l.style.width=u,l.style.bottom=0,l.style.right=0,l.style.display="none",h=!1;var e=void 0!==l.style.opacity,t=!e&&void 0!==l.style.filter;e&&(l.style.opacity=parseFloat(1)),t&&(l.style.filter="alpha(opacity=100)"),l.style.MozOpacity=parseFloat(1)}function g(e,t,i,o){return i*((e=e/o-1)*e*e*e*e+1)+t}this.ScriptId=0,this.Initilize=function(e,t,i,o,n){d=o,c=t,u=i,(l=e).style.height=c+"px",l.style.width=u+"px",h=!1,p=n},this.Close=function(e,t){var i,o,n,a;e&&(l=document.getElementById("iFraC4AW"+e)),l&&(null!=C&&clearInterval(C),i=c,o=(new Date).getTime(),a=n=0,C=setInterval(function(){n=(new Date).getTime()-o,a=g(n,i,0-i,1e3),l.style.height=a+"px",1e3<=n&&(r(),clearInterval(C))},1e3/60),this.GreyOutHide(),A.Log("Animation.Close() setting blank src for iframe id: "+l.id+" original src:"+l.src),t||(l.src="about:blank"))},this.GreyOutHide=function(){var e=document.getElementById("C4A_divGreyOut");e&&document.body.removeChild(e),r()},this.GreyOutShow=function(){var e=document.body,t=document.documentElement,i=Math.max(e.scrollWidth,e.offsetWidth,t.clientWidth,t.scrollWidth,t.offsetWidth),e=Math.max(e.scrollHeight,e.offsetHeight,t.clientHeight,t.scrollHeight,t.offsetHeight),t=document.getElementById("C4A_divGreyOut");t||((t=document.createElement("div")).id="C4A_divGreyOut",t.setAttribute("style","position:absolute; top:0; left:0;width:"+i+"px; height:"+e+'px; z-index:2147483600; background-color: rgba(0, 0, 0, 0.8); -ms-filter: "progid:DXImageTransform.Microsoft.Alpha(Opacity=80)";background-color: #000000\\0/;  '),document.body.appendChild(t),t.addEventListener?t.addEventListener("click",C4A.Animation.GreyOutHide,!1):t.attachEvent?t.attachEvent("onclick",C4A.Animation.GreyOutHide):t.onclick=C4A.Animation.GreyOutHide)},this.Animate=function(e){var t,i,o,n,a,r,s;l&&(t=function(e,t,i){var o=0,n=0,a=0,r=0,s=m.UIGetWindowHeightWidth(),l=m.UIGetScrollPosition();1==e&&(o=s.Height/2-t/2+l.TopOffset,n=s.Width/2-i/2+l.LeftOffset,a=o,r=n);2==e&&(o=s.Height/2-t/2+l.TopOffset,n=0-i+l.LeftOffset,a=o,r=s.Width/2-i/2+l.LeftOffset);3==e&&(o=0-t+l.TopOffset,n=s.Width-i+l.LeftOffset,a=s.Height-t+l.TopOffset,r=n);4==e&&(o=s.Height+t+l.TopOffset,n=s.Width-i+l.LeftOffset,a=s.Height-t+l.TopOffset,r=n);6==e&&(o=s.Height/2-t/2+l.TopOffset,n=s.Width+i+l.LeftOffset,a=o,r=s.Width/2-i/2+l.LeftOffset);l=new Array;return l.StartTop=o,l.StartLeft=n,l.StopTop=a,l.StopLeft=r,l}(e,c,u),n=o=i=0,a=(new Date).getTime(),h||(p?this.GreyOutShow():this.GreyOutHide(),h=!0,1==e&&(l.style.top=t.StopTop+"px",l.style.left=t.StopLeft+"px",l.style.height=c+"px",l.style.width=u+"px",l.style.position="absolute",l.style.display="none",i=t.StartLeft,o=t.StopLeft,r=0,s=setInterval(function(){var e,t;h?(t=!(e=void 0!==l.style.opacity)&&void 0!==l.style.filter,e&&(l.style.opacity=parseFloat(r/100)),t&&(l.style.filter="alpha(opacity="+r+")"),l.style.MozOpacity=parseFloat(r/100),r++,l.style.display="block",100<=r&&(h=!1,clearInterval(s))):clearInterval(s)},1e3/60)),2==e&&(l.style.display="block",l.style.top=t.StartTop+"px",l.style.left=t.StartLeft+"px",l.style.height=c+"px",l.style.width=u+"px",l.style.position="absolute",l.style.bottom="",l.style.right="",i=t.StartLeft,o=t.StopLeft,n=2e3,s=setInterval(function(){var e,t;h?(t=g(e=(new Date).getTime()-a,i,o-i,n),l.style.left=t+"px",(n<=e||!h)&&(h=!1,clearInterval(s))):clearInterval(s)},1e3/60)),3==e&&(l.style.display="block",l.style.top=t.StartTop+"px",l.style.left="",l.style.height=c+"px",l.style.width=u+"px",l.style.bottom="0",l.style.right="0",l.style.position="absolute",i=t.StartTop,o=t.StopTop,n=2e3,s=setInterval(function(){var e,t;h?(t=g(e=(new Date).getTime()-a,i,o-i,n),l.style.top=t+"px",(n<=e||!h)&&(l.style.bottom="0",l.style.right="0",l.style.position="fixed",l.style.top="",h=!1,clearInterval(s))):clearInterval(s)},1e3/60)),4==e&&(l.style.display="block",l.style.position="fixed",l.style.height="0",l.style.width=u+"px","true"==l.getAttribute("AlignRight")?(l.style.left="",l.style.right="0"):(l.style.left="0",l.style.right=""),l.style.bottom="0",l.style.top="",i=0,o=c,n=2e3,null!=C&&clearInterval(C),C=setInterval(function(){var e,t;h?(t=g(e=(new Date).getTime()-a,i,o-i,n),l.style.height=t+"px",(n<=e||!h)&&(l.style.display="block",h=!1,clearInterval(C))):clearInterval(C)},1e3/60)),5==e&&(l.style.display="block",l.style.top=d,l.style.left="0px",l.style.height=c+"px",l.style.width="0px",l.style.position="fixed",l.style.bottom="",l.style.right="",i=0,o=u,n=1e3,null!=C&&clearInterval(C),C=setInterval(function(){var e,t;h?(A.Log("Animation:Animate:_iFra.id"+l.id),t=g(e=(new Date).getTime()-a,i,o-i,n),l.style.width=t+"px",(n<=e||!h)&&(h=!1,clearInterval(C))):clearInterval(C)},1e3/60)),6==e&&(l.style.display="block",l.style.top=t.StartTop+"px",l.style.right=-u+"px",l.style.height=c+"px",l.style.width=u+"px",l.style.position="fixed",l.style.bottom="",l.style.left="",i=t.StartLeft,o=t.StopLeft,n=2e3,s=setInterval(function(){var e,t;h?(t=g(e=(new Date).getTime()-a,i,o-i,n),l.style.left=t+"px",(n<=e||!h)&&(h=!1,clearInterval(s),l.style.position="absolute")):(clearInterval(s),l.style.position="absolute")},1e3/60))))}},Debug:A,iOSFix:!0}}();C4ALoaded?console.warn("Click4Assistance C4A.Run() called multiple times, potentially duplicate C4A script on web page."):InitialiseC4A();